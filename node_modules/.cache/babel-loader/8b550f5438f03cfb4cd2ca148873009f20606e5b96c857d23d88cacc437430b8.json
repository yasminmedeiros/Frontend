{"ast":null,"code":"'use strict';\n\nmodule.exports = createScene;\nvar createCamera = require('3d-view-controls');\nvar createAxes = require('gl-axes3d');\nvar axesRanges = require('gl-axes3d/properties');\nvar createSpikes = require('gl-spikes3d');\nvar createSelect = require('gl-select-static');\nvar createFBO = require('gl-fbo');\nvar drawTriangle = require('a-big-triangle');\nvar mouseChange = require('mouse-change');\nvar perspective = require('gl-mat4/perspective');\nvar createShader = require('./lib/shader');\nvar isMobile = require('is-mobile')({\n  tablet: true\n});\nfunction MouseSelect() {\n  this.mouse = [-1, -1];\n  this.screen = null;\n  this.distance = Infinity;\n  this.index = null;\n  this.dataCoordinate = null;\n  this.dataPosition = null;\n  this.object = null;\n  this.data = null;\n}\nfunction getContext(canvas, options) {\n  var gl = null;\n  try {\n    gl = canvas.getContext('webgl', options);\n    if (!gl) {\n      gl = canvas.getContext('experimental-webgl', options);\n    }\n  } catch (e) {\n    return null;\n  }\n  return gl;\n}\nfunction roundUpPow10(x) {\n  var y = Math.round(Math.log(Math.abs(x)) / Math.log(10));\n  if (y < 0) {\n    var base = Math.round(Math.pow(10, -y));\n    return Math.ceil(x * base) / base;\n  } else if (y > 0) {\n    var base = Math.round(Math.pow(10, y));\n    return Math.ceil(x / base) * base;\n  }\n  return Math.ceil(x);\n}\nfunction defaultBool(x) {\n  if (typeof x === 'boolean') {\n    return x;\n  }\n  return true;\n}\nfunction createScene(options) {\n  options = options || {};\n  var stopped = false;\n  var pixelRatio = options.pixelRatio || parseFloat(window.devicePixelRatio);\n  var canvas = options.canvas;\n  if (!canvas) {\n    canvas = document.createElement('canvas');\n    if (options.container) {\n      var container = options.container;\n      container.appendChild(canvas);\n    } else {\n      document.body.appendChild(canvas);\n    }\n  }\n  var gl = options.gl;\n  if (!gl) {\n    gl = getContext(canvas, options.glOptions || {\n      premultipliedAlpha: true,\n      antialias: true,\n      preserveDrawingBuffer: isMobile\n    });\n  }\n  if (!gl) {\n    throw new Error('webgl not supported');\n  }\n\n  //Initial bounds\n  var bounds = options.bounds || [[-10, -10, -10], [10, 10, 10]];\n\n  //Create selection\n  var selection = new MouseSelect();\n\n  //Accumulation buffer\n  var accumBuffer = createFBO(gl, [gl.drawingBufferWidth, gl.drawingBufferHeight], {\n    preferFloat: !isMobile\n  });\n  var accumShader = createShader(gl);\n\n  //Create a camera\n  var cameraOptions = options.camera || {\n    eye: [2, 0, 0],\n    center: [0, 0, 0],\n    up: [0, 1, 0],\n    zoomMin: 0.1,\n    zoomMax: 100,\n    mode: 'turntable'\n  };\n\n  //Create axes\n  var axesOptions = options.axes || {};\n  var axes = createAxes(gl, axesOptions);\n  axes.enable = !axesOptions.disable;\n\n  //Create spikes\n  var spikeOptions = options.spikes || {};\n  var spikes = createSpikes(gl, spikeOptions);\n\n  //Object list is empty initially\n  var objects = [];\n  var pickBufferIds = [];\n  var pickBufferCount = [];\n  var pickBuffers = [];\n\n  //Dirty flag, skip redraw if scene static\n  var dirty = true;\n  var pickDirty = true;\n  var projection = new Array(16);\n  var model = new Array(16);\n  var cameraParams = {\n    view: null,\n    projection: projection,\n    model: model\n  };\n  var pickDirty = true;\n  var viewShape = [gl.drawingBufferWidth, gl.drawingBufferHeight];\n\n  //Create scene object\n  var scene = {\n    gl: gl,\n    contextLost: false,\n    pixelRatio: options.pixelRatio || parseFloat(window.devicePixelRatio),\n    canvas: canvas,\n    selection: selection,\n    camera: createCamera(canvas, cameraOptions),\n    axes: axes,\n    axesPixels: null,\n    spikes: spikes,\n    bounds: bounds,\n    objects: objects,\n    shape: viewShape,\n    aspect: options.aspectRatio || [1, 1, 1],\n    pickRadius: options.pickRadius || 10,\n    zNear: options.zNear || 0.01,\n    zFar: options.zFar || 1000,\n    fovy: options.fovy || Math.PI / 4,\n    clearColor: options.clearColor || [0, 0, 0, 0],\n    autoResize: defaultBool(options.autoResize),\n    autoBounds: defaultBool(options.autoBounds),\n    autoScale: !!options.autoScale,\n    autoCenter: defaultBool(options.autoCenter),\n    clipToBounds: defaultBool(options.clipToBounds),\n    snapToData: !!options.snapToData,\n    onselect: options.onselect || null,\n    onrender: options.onrender || null,\n    onclick: options.onclick || null,\n    cameraParams: cameraParams,\n    oncontextloss: null,\n    mouseListener: null\n  };\n  var pickShape = [gl.drawingBufferWidth / scene.pixelRatio | 0, gl.drawingBufferHeight / scene.pixelRatio | 0];\n  function resizeListener() {\n    if (stopped) {\n      return;\n    }\n    if (!scene.autoResize) {\n      return;\n    }\n    var parent = canvas.parentNode;\n    var width = 1;\n    var height = 1;\n    if (parent && parent !== document.body) {\n      width = parent.clientWidth;\n      height = parent.clientHeight;\n    } else {\n      width = window.innerWidth;\n      height = window.innerHeight;\n    }\n    var nextWidth = Math.ceil(width * scene.pixelRatio) | 0;\n    var nextHeight = Math.ceil(height * scene.pixelRatio) | 0;\n    if (nextWidth !== canvas.width || nextHeight !== canvas.height) {\n      canvas.width = nextWidth;\n      canvas.height = nextHeight;\n      var style = canvas.style;\n      style.position = style.position || 'absolute';\n      style.left = '0px';\n      style.top = '0px';\n      style.width = width + 'px';\n      style.height = height + 'px';\n      dirty = true;\n    }\n  }\n  if (scene.autoResize) {\n    resizeListener();\n  }\n  window.addEventListener('resize', resizeListener);\n  function reallocPickIds() {\n    var numObjs = objects.length;\n    var numPick = pickBuffers.length;\n    for (var i = 0; i < numPick; ++i) {\n      pickBufferCount[i] = 0;\n    }\n    obj_loop: for (var i = 0; i < numObjs; ++i) {\n      var obj = objects[i];\n      var pickCount = obj.pickSlots;\n      if (!pickCount) {\n        pickBufferIds[i] = -1;\n        continue;\n      }\n      for (var j = 0; j < numPick; ++j) {\n        if (pickBufferCount[j] + pickCount < 255) {\n          pickBufferIds[i] = j;\n          obj.setPickBase(pickBufferCount[j] + 1);\n          pickBufferCount[j] += pickCount;\n          continue obj_loop;\n        }\n      }\n      //Create new pick buffer\n      var nbuffer = createSelect(gl, viewShape);\n      pickBufferIds[i] = numPick;\n      pickBuffers.push(nbuffer);\n      pickBufferCount.push(pickCount);\n      obj.setPickBase(1);\n      numPick += 1;\n    }\n    while (numPick > 0 && pickBufferCount[numPick - 1] === 0) {\n      pickBufferCount.pop();\n      pickBuffers.pop().dispose();\n    }\n  }\n  scene.update = function (options) {\n    if (stopped) {\n      return;\n    }\n    options = options || {};\n    dirty = true;\n    pickDirty = true;\n  };\n  scene.add = function (obj) {\n    if (stopped) {\n      return;\n    }\n    obj.axes = axes;\n    objects.push(obj);\n    pickBufferIds.push(-1);\n    dirty = true;\n    pickDirty = true;\n    reallocPickIds();\n  };\n  scene.remove = function (obj) {\n    if (stopped) {\n      return;\n    }\n    var idx = objects.indexOf(obj);\n    if (idx < 0) {\n      return;\n    }\n    objects.splice(idx, 1);\n    pickBufferIds.pop();\n    dirty = true;\n    pickDirty = true;\n    reallocPickIds();\n  };\n  scene.dispose = function () {\n    if (stopped) {\n      return;\n    }\n    stopped = true;\n    window.removeEventListener('resize', resizeListener);\n    canvas.removeEventListener('webglcontextlost', checkContextLoss);\n    scene.mouseListener.enabled = false;\n    if (scene.contextLost) {\n      return;\n    }\n\n    //Destroy objects\n    axes.dispose();\n    spikes.dispose();\n    for (var i = 0; i < objects.length; ++i) {\n      objects[i].dispose();\n    }\n\n    //Clean up buffers\n    accumBuffer.dispose();\n    for (var i = 0; i < pickBuffers.length; ++i) {\n      pickBuffers[i].dispose();\n    }\n\n    //Clean up shaders\n    accumShader.dispose();\n\n    //Release all references\n    gl = null;\n    axes = null;\n    spikes = null;\n    objects = [];\n  };\n\n  //Update mouse position\n  var mouseRotating = false;\n  var prevButtons = 0;\n  scene.mouseListener = mouseChange(canvas, function (buttons, x, y) {\n    if (stopped) {\n      return;\n    }\n    var numPick = pickBuffers.length;\n    var numObjs = objects.length;\n    var prevObj = selection.object;\n    selection.distance = Infinity;\n    selection.mouse[0] = x;\n    selection.mouse[1] = y;\n    selection.object = null;\n    selection.screen = null;\n    selection.dataCoordinate = selection.dataPosition = null;\n    var change = false;\n    if (buttons && prevButtons) {\n      mouseRotating = true;\n    } else {\n      if (mouseRotating) {\n        pickDirty = true;\n      }\n      mouseRotating = false;\n      for (var i = 0; i < numPick; ++i) {\n        var result = pickBuffers[i].query(x, pickShape[1] - y - 1, scene.pickRadius);\n        if (result) {\n          if (result.distance > selection.distance) {\n            continue;\n          }\n          for (var j = 0; j < numObjs; ++j) {\n            var obj = objects[j];\n            if (pickBufferIds[j] !== i) {\n              continue;\n            }\n            var objPick = obj.pick(result);\n            if (objPick) {\n              selection.buttons = buttons;\n              selection.screen = result.coord;\n              selection.distance = result.distance;\n              selection.object = obj;\n              selection.index = objPick.distance;\n              selection.dataPosition = objPick.position;\n              selection.dataCoordinate = objPick.dataCoordinate;\n              selection.data = objPick;\n              change = true;\n            }\n          }\n        }\n      }\n    }\n    if (prevObj && prevObj !== selection.object) {\n      if (prevObj.highlight) {\n        prevObj.highlight(null);\n      }\n      dirty = true;\n    }\n    if (selection.object) {\n      if (selection.object.highlight) {\n        selection.object.highlight(selection.data);\n      }\n      dirty = true;\n    }\n    change = change || selection.object !== prevObj;\n    if (change && scene.onselect) {\n      scene.onselect(selection);\n    }\n    if (buttons & 1 && !(prevButtons & 1) && scene.onclick) {\n      scene.onclick(selection);\n    }\n    prevButtons = buttons;\n  });\n  function checkContextLoss() {\n    if (scene.contextLost) {\n      return true;\n    }\n    if (gl.isContextLost()) {\n      scene.contextLost = true;\n      scene.mouseListener.enabled = false;\n      scene.selection.object = null;\n      if (scene.oncontextloss) {\n        scene.oncontextloss();\n      }\n    }\n  }\n  canvas.addEventListener('webglcontextlost', checkContextLoss);\n\n  //Render the scene for mouse picking\n  function renderPick() {\n    if (checkContextLoss()) {\n      return;\n    }\n    gl.colorMask(true, true, true, true);\n    gl.depthMask(true);\n    gl.disable(gl.BLEND);\n    gl.enable(gl.DEPTH_TEST);\n    var numObjs = objects.length;\n    var numPick = pickBuffers.length;\n    for (var j = 0; j < numPick; ++j) {\n      var buf = pickBuffers[j];\n      buf.shape = pickShape;\n      buf.begin();\n      for (var i = 0; i < numObjs; ++i) {\n        if (pickBufferIds[i] !== j) {\n          continue;\n        }\n        var obj = objects[i];\n        if (obj.drawPick) {\n          obj.pixelRatio = 1;\n          obj.drawPick(cameraParams);\n        }\n      }\n      buf.end();\n    }\n  }\n  var nBounds = [[Infinity, Infinity, Infinity], [-Infinity, -Infinity, -Infinity]];\n  var prevBounds = [nBounds[0].slice(), nBounds[1].slice()];\n  function redraw() {\n    if (checkContextLoss()) {\n      return;\n    }\n    resizeListener();\n\n    //Tick camera\n    var cameraMoved = scene.camera.tick();\n    cameraParams.view = scene.camera.matrix;\n    dirty = dirty || cameraMoved;\n    pickDirty = pickDirty || cameraMoved;\n\n    //Set pixel ratio\n    axes.pixelRatio = scene.pixelRatio;\n    spikes.pixelRatio = scene.pixelRatio;\n\n    //Check if any objects changed, recalculate bounds\n    var numObjs = objects.length;\n    var lo = nBounds[0];\n    var hi = nBounds[1];\n    lo[0] = lo[1] = lo[2] = Infinity;\n    hi[0] = hi[1] = hi[2] = -Infinity;\n    for (var i = 0; i < numObjs; ++i) {\n      var obj = objects[i];\n\n      //Set the axes properties for each object\n      obj.pixelRatio = scene.pixelRatio;\n      obj.axes = scene.axes;\n      dirty = dirty || !!obj.dirty;\n      pickDirty = pickDirty || !!obj.dirty;\n      var obb = obj.bounds;\n      if (obb) {\n        var olo = obb[0];\n        var ohi = obb[1];\n        for (var j = 0; j < 3; ++j) {\n          lo[j] = Math.min(lo[j], olo[j]);\n          hi[j] = Math.max(hi[j], ohi[j]);\n        }\n      }\n    }\n\n    //Recalculate bounds\n    var bounds = scene.bounds;\n    if (scene.autoBounds) {\n      for (var j = 0; j < 3; ++j) {\n        if (hi[j] < lo[j]) {\n          lo[j] = -1;\n          hi[j] = 1;\n        } else {\n          if (lo[j] === hi[j]) {\n            lo[j] -= 1;\n            hi[j] += 1;\n          }\n          var padding = 0.05 * (hi[j] - lo[j]);\n          lo[j] = lo[j] - padding;\n          hi[j] = hi[j] + padding;\n        }\n        bounds[0][j] = lo[j];\n        bounds[1][j] = hi[j];\n      }\n    }\n    var boundsChanged = false;\n    for (var j = 0; j < 3; ++j) {\n      boundsChanged = boundsChanged || prevBounds[0][j] !== bounds[0][j] || prevBounds[1][j] !== bounds[1][j];\n      prevBounds[0][j] = bounds[0][j];\n      prevBounds[1][j] = bounds[1][j];\n    }\n\n    //Recalculate bounds\n    pickDirty = pickDirty || boundsChanged;\n    dirty = dirty || boundsChanged;\n    if (!dirty) {\n      return;\n    }\n    if (boundsChanged) {\n      var tickSpacing = [0, 0, 0];\n      for (var i = 0; i < 3; ++i) {\n        tickSpacing[i] = roundUpPow10((bounds[1][i] - bounds[0][i]) / 10.0);\n      }\n      if (axes.autoTicks) {\n        axes.update({\n          bounds: bounds,\n          tickSpacing: tickSpacing\n        });\n      } else {\n        axes.update({\n          bounds: bounds\n        });\n      }\n    }\n\n    //Get scene\n    var width = gl.drawingBufferWidth;\n    var height = gl.drawingBufferHeight;\n    viewShape[0] = width;\n    viewShape[1] = height;\n    pickShape[0] = Math.max(width / scene.pixelRatio, 1) | 0;\n    pickShape[1] = Math.max(height / scene.pixelRatio, 1) | 0;\n\n    //Compute camera parameters\n    perspective(projection, scene.fovy, width / height, scene.zNear, scene.zFar);\n\n    //Compute model matrix\n    for (var i = 0; i < 16; ++i) {\n      model[i] = 0;\n    }\n    model[15] = 1;\n    var maxS = 0;\n    for (var i = 0; i < 3; ++i) {\n      maxS = Math.max(maxS, bounds[1][i] - bounds[0][i]);\n    }\n    for (var i = 0; i < 3; ++i) {\n      if (scene.autoScale) {\n        model[5 * i] = scene.aspect[i] / (bounds[1][i] - bounds[0][i]);\n      } else {\n        model[5 * i] = 1 / maxS;\n      }\n      if (scene.autoCenter) {\n        model[12 + i] = -model[5 * i] * 0.5 * (bounds[0][i] + bounds[1][i]);\n      }\n    }\n\n    //Apply axes/clip bounds\n    for (var i = 0; i < numObjs; ++i) {\n      var obj = objects[i];\n\n      //Set axes bounds\n      obj.axesBounds = bounds;\n\n      //Set clip bounds\n      if (scene.clipToBounds) {\n        obj.clipBounds = bounds;\n      }\n    }\n    //Set spike parameters\n    if (selection.object) {\n      if (scene.snapToData) {\n        spikes.position = selection.dataCoordinate;\n      } else {\n        spikes.position = selection.dataPosition;\n      }\n      spikes.bounds = bounds;\n    }\n\n    //If state changed, then redraw pick buffers\n    if (pickDirty) {\n      pickDirty = false;\n      renderPick();\n    }\n\n    //Recalculate pixel data\n    scene.axesPixels = axesRanges(scene.axes, cameraParams, width, height);\n\n    //Call render callback\n    if (scene.onrender) {\n      scene.onrender();\n    }\n\n    //Read value\n    gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n    gl.viewport(0, 0, width, height);\n\n    //General strategy: 3 steps\n    //  1. render non-transparent objects\n    //  2. accumulate transparent objects into separate fbo\n    //  3. composite final scene\n\n    //Clear FBO\n    var clearColor = scene.clearColor;\n    gl.clearColor(clearColor[0], clearColor[1], clearColor[2], clearColor[3]);\n    gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n    gl.depthMask(true);\n    gl.colorMask(true, true, true, true);\n    gl.enable(gl.DEPTH_TEST);\n    gl.depthFunc(gl.LEQUAL);\n    gl.disable(gl.BLEND);\n    gl.disable(gl.CULL_FACE); //most visualization surfaces are 2 sided\n\n    //Render opaque pass\n    var hasTransparent = false;\n    if (axes.enable) {\n      hasTransparent = hasTransparent || axes.isTransparent();\n      axes.draw(cameraParams);\n    }\n    spikes.axes = axes;\n    if (selection.object) {\n      spikes.draw(cameraParams);\n    }\n    gl.disable(gl.CULL_FACE); //most visualization surfaces are 2 sided\n\n    for (var i = 0; i < numObjs; ++i) {\n      var obj = objects[i];\n      obj.axes = axes;\n      obj.pixelRatio = scene.pixelRatio;\n      if (obj.isOpaque && obj.isOpaque()) {\n        obj.draw(cameraParams);\n      }\n      if (obj.isTransparent && obj.isTransparent()) {\n        hasTransparent = true;\n      }\n    }\n    if (hasTransparent) {\n      //Render transparent pass\n      accumBuffer.shape = viewShape;\n      accumBuffer.bind();\n      gl.clear(gl.DEPTH_BUFFER_BIT);\n      gl.colorMask(false, false, false, false);\n      gl.depthMask(true);\n      gl.depthFunc(gl.LESS);\n\n      //Render forward facing objects\n      if (axes.enable && axes.isTransparent()) {\n        axes.drawTransparent(cameraParams);\n      }\n      for (var i = 0; i < numObjs; ++i) {\n        var obj = objects[i];\n        if (obj.isOpaque && obj.isOpaque()) {\n          obj.draw(cameraParams);\n        }\n      }\n\n      //Render transparent pass\n      gl.enable(gl.BLEND);\n      gl.blendEquation(gl.FUNC_ADD);\n      gl.blendFunc(gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\n      gl.colorMask(true, true, true, true);\n      gl.depthMask(false);\n      gl.clearColor(0, 0, 0, 0);\n      gl.clear(gl.COLOR_BUFFER_BIT);\n      if (axes.isTransparent()) {\n        axes.drawTransparent(cameraParams);\n      }\n      for (var i = 0; i < numObjs; ++i) {\n        var obj = objects[i];\n        if (obj.isTransparent && obj.isTransparent()) {\n          obj.drawTransparent(cameraParams);\n        }\n      }\n\n      //Unbind framebuffer\n      gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n\n      //Draw composite pass\n      gl.blendFunc(gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\n      gl.disable(gl.DEPTH_TEST);\n      accumShader.bind();\n      accumBuffer.color[0].bind(0);\n      accumShader.uniforms.accumBuffer = 0;\n      drawTriangle(gl);\n\n      //Turn off blending\n      gl.disable(gl.BLEND);\n    }\n\n    //Clear dirty flags\n    dirty = false;\n    for (var i = 0; i < numObjs; ++i) {\n      objects[i].dirty = false;\n    }\n  }\n\n  //Draw the whole scene\n  function render() {\n    if (stopped || scene.contextLost) {\n      return;\n    }\n    // this order is important: ios safari sometimes has sync raf\n    redraw();\n    requestAnimationFrame(render);\n  }\n  render();\n\n  //Force redraw of whole scene\n  scene.redraw = function () {\n    if (stopped) {\n      return;\n    }\n    dirty = true;\n    redraw();\n  };\n  return scene;\n}","map":{"version":3,"names":["module","exports","createScene","createCamera","require","createAxes","axesRanges","createSpikes","createSelect","createFBO","drawTriangle","mouseChange","perspective","createShader","isMobile","tablet","MouseSelect","mouse","screen","distance","Infinity","index","dataCoordinate","dataPosition","object","data","getContext","canvas","options","gl","e","roundUpPow10","x","y","Math","round","log","abs","base","pow","ceil","defaultBool","stopped","pixelRatio","parseFloat","window","devicePixelRatio","document","createElement","container","appendChild","body","glOptions","premultipliedAlpha","antialias","preserveDrawingBuffer","Error","bounds","selection","accumBuffer","drawingBufferWidth","drawingBufferHeight","preferFloat","accumShader","cameraOptions","camera","eye","center","up","zoomMin","zoomMax","mode","axesOptions","axes","enable","disable","spikeOptions","spikes","objects","pickBufferIds","pickBufferCount","pickBuffers","dirty","pickDirty","projection","Array","model","cameraParams","view","viewShape","scene","contextLost","axesPixels","shape","aspect","aspectRatio","pickRadius","zNear","zFar","fovy","PI","clearColor","autoResize","autoBounds","autoScale","autoCenter","clipToBounds","snapToData","onselect","onrender","onclick","oncontextloss","mouseListener","pickShape","resizeListener","parent","parentNode","width","height","clientWidth","clientHeight","innerWidth","innerHeight","nextWidth","nextHeight","style","position","left","top","addEventListener","reallocPickIds","numObjs","length","numPick","i","obj_loop","obj","pickCount","pickSlots","j","setPickBase","nbuffer","push","pop","dispose","update","add","remove","idx","indexOf","splice","removeEventListener","checkContextLoss","enabled","mouseRotating","prevButtons","buttons","prevObj","change","result","query","objPick","pick","coord","highlight","isContextLost","renderPick","colorMask","depthMask","BLEND","DEPTH_TEST","buf","begin","drawPick","end","nBounds","prevBounds","slice","redraw","cameraMoved","tick","matrix","lo","hi","obb","olo","ohi","min","max","padding","boundsChanged","tickSpacing","autoTicks","maxS","axesBounds","clipBounds","bindFramebuffer","FRAMEBUFFER","viewport","clear","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","depthFunc","LEQUAL","CULL_FACE","hasTransparent","isTransparent","draw","isOpaque","bind","LESS","drawTransparent","blendEquation","FUNC_ADD","blendFunc","ONE","ONE_MINUS_SRC_ALPHA","color","uniforms","render","requestAnimationFrame"],"sources":["/home/yasmin/Área de Trabalho/Frontend/node_modules/gl-plot3d/scene.js"],"sourcesContent":["'use strict'\n\nmodule.exports = createScene\n\nvar createCamera = require('3d-view-controls')\nvar createAxes   = require('gl-axes3d')\nvar axesRanges   = require('gl-axes3d/properties')\nvar createSpikes = require('gl-spikes3d')\nvar createSelect = require('gl-select-static')\nvar createFBO    = require('gl-fbo')\nvar drawTriangle = require('a-big-triangle')\nvar mouseChange  = require('mouse-change')\nvar perspective  = require('gl-mat4/perspective')\nvar createShader = require('./lib/shader')\nvar isMobile = require('is-mobile')({ tablet: true })\n\nfunction MouseSelect() {\n  this.mouse          = [-1,-1]\n  this.screen         = null\n  this.distance       = Infinity\n  this.index          = null\n  this.dataCoordinate = null\n  this.dataPosition   = null\n  this.object         = null\n  this.data           = null\n}\n\nfunction getContext(canvas, options) {\n  var gl = null\n  try {\n    gl = canvas.getContext('webgl', options)\n    if(!gl) {\n      gl = canvas.getContext('experimental-webgl', options)\n    }\n  } catch(e) {\n    return null\n  }\n  return gl\n}\n\nfunction roundUpPow10(x) {\n  var y = Math.round(Math.log(Math.abs(x)) / Math.log(10))\n  if(y < 0) {\n    var base = Math.round(Math.pow(10, -y))\n    return Math.ceil(x*base) / base\n  } else if(y > 0) {\n    var base = Math.round(Math.pow(10, y))\n    return Math.ceil(x/base) * base\n  }\n  return Math.ceil(x)\n}\n\nfunction defaultBool(x) {\n  if(typeof x === 'boolean') {\n    return x\n  }\n  return true\n}\n\nfunction createScene(options) {\n  options = options || {}\n\n  var stopped = false\n\n  var pixelRatio = options.pixelRatio || parseFloat(window.devicePixelRatio)\n\n  var canvas = options.canvas\n  if(!canvas) {\n    canvas = document.createElement('canvas')\n    if(options.container) {\n      var container = options.container\n      container.appendChild(canvas)\n    } else {\n      document.body.appendChild(canvas)\n    }\n  }\n\n  var gl = options.gl\n  if(!gl) {\n    gl = getContext(canvas,\n      options.glOptions || {\n        premultipliedAlpha: true,\n        antialias: true,\n        preserveDrawingBuffer: isMobile\n      })\n  }\n  if(!gl) {\n    throw new Error('webgl not supported')\n  }\n\n  //Initial bounds\n  var bounds = options.bounds || [[-10,-10,-10], [10,10,10]]\n\n  //Create selection\n  var selection = new MouseSelect()\n\n  //Accumulation buffer\n  var accumBuffer = createFBO(gl,\n    [gl.drawingBufferWidth, gl.drawingBufferHeight], {\n      preferFloat: !isMobile\n    })\n\n  var accumShader = createShader(gl)\n\n  //Create a camera\n  var cameraOptions = options.camera || {\n    eye:    [2,0,0],\n    center: [0,0,0],\n    up:     [0,1,0],\n    zoomMin: 0.1,\n    zoomMax: 100,\n    mode:    'turntable'\n  }\n\n  //Create axes\n  var axesOptions = options.axes || {}\n  var axes = createAxes(gl, axesOptions)\n  axes.enable = !axesOptions.disable\n\n  //Create spikes\n  var spikeOptions = options.spikes || {}\n  var spikes = createSpikes(gl, spikeOptions)\n\n  //Object list is empty initially\n  var objects         = []\n  var pickBufferIds   = []\n  var pickBufferCount = []\n  var pickBuffers     = []\n\n  //Dirty flag, skip redraw if scene static\n  var dirty       = true\n  var pickDirty   = true\n\n  var projection     = new Array(16)\n  var model          = new Array(16)\n\n  var cameraParams = {\n    view:         null,\n    projection:   projection,\n    model:        model\n  }\n\n  var pickDirty = true\n\n  var viewShape = [ gl.drawingBufferWidth, gl.drawingBufferHeight ]\n\n  //Create scene object\n  var scene = {\n    gl:           gl,\n    contextLost:  false,\n    pixelRatio:   options.pixelRatio || parseFloat(window.devicePixelRatio),\n    canvas:       canvas,\n    selection:    selection,\n    camera:       createCamera(canvas, cameraOptions),\n    axes:         axes,\n    axesPixels:   null,\n    spikes:       spikes,\n    bounds:       bounds,\n    objects:      objects,\n    shape:        viewShape,\n    aspect:       options.aspectRatio || [1,1,1],\n    pickRadius:   options.pickRadius || 10,\n    zNear:        options.zNear || 0.01,\n    zFar:         options.zFar  || 1000,\n    fovy:         options.fovy  || Math.PI/4,\n    clearColor:   options.clearColor || [0,0,0,0],\n    autoResize:   defaultBool(options.autoResize),\n    autoBounds:   defaultBool(options.autoBounds),\n    autoScale:    !!options.autoScale,\n    autoCenter:   defaultBool(options.autoCenter),\n    clipToBounds: defaultBool(options.clipToBounds),\n    snapToData:   !!options.snapToData,\n    onselect:     options.onselect || null,\n    onrender:     options.onrender || null,\n    onclick:      options.onclick  || null,\n    cameraParams: cameraParams,\n    oncontextloss: null,\n    mouseListener: null\n  }\n\n  var pickShape = [ (gl.drawingBufferWidth/scene.pixelRatio)|0, (gl.drawingBufferHeight/scene.pixelRatio)|0 ]\n\n  function resizeListener() {\n    if(stopped) {\n      return\n    }\n    if(!scene.autoResize) {\n      return\n    }\n    var parent = canvas.parentNode\n    var width  = 1\n    var height = 1\n    if(parent && parent !== document.body) {\n      width  = parent.clientWidth\n      height = parent.clientHeight\n    } else {\n      width  = window.innerWidth\n      height = window.innerHeight\n    }\n    var nextWidth  = Math.ceil(width  * scene.pixelRatio)|0\n    var nextHeight = Math.ceil(height * scene.pixelRatio)|0\n    if(nextWidth !== canvas.width || nextHeight !== canvas.height) {\n      canvas.width   = nextWidth\n      canvas.height  = nextHeight\n      var style = canvas.style\n      style.position = style.position || 'absolute'\n      style.left     = '0px'\n      style.top      = '0px'\n      style.width    = width  + 'px'\n      style.height   = height + 'px'\n      dirty = true\n    }\n  }\n  if(scene.autoResize) {\n    resizeListener()\n  }\n  window.addEventListener('resize', resizeListener)\n\n  function reallocPickIds() {\n    var numObjs = objects.length\n    var numPick = pickBuffers.length\n    for(var i=0; i<numPick; ++i) {\n      pickBufferCount[i] = 0\n    }\n    obj_loop:\n    for(var i=0; i<numObjs; ++i) {\n      var obj = objects[i]\n      var pickCount = obj.pickSlots\n      if(!pickCount) {\n        pickBufferIds[i] = -1\n        continue\n      }\n      for(var j=0; j<numPick; ++j) {\n        if(pickBufferCount[j] + pickCount < 255) {\n          pickBufferIds[i] = j\n          obj.setPickBase(pickBufferCount[j]+1)\n          pickBufferCount[j] += pickCount\n          continue obj_loop\n        }\n      }\n      //Create new pick buffer\n      var nbuffer = createSelect(gl, viewShape)\n      pickBufferIds[i] = numPick\n      pickBuffers.push(nbuffer)\n      pickBufferCount.push(pickCount)\n      obj.setPickBase(1)\n      numPick += 1\n    }\n    while(numPick > 0 && pickBufferCount[numPick-1] === 0) {\n      pickBufferCount.pop()\n      pickBuffers.pop().dispose()\n    }\n  }\n\n  scene.update = function(options) {\n    if(stopped) {\n      return\n    }\n    options = options || {}\n    dirty = true\n    pickDirty = true\n  }\n\n  scene.add = function(obj) {\n    if(stopped) {\n      return\n    }\n    obj.axes = axes\n    objects.push(obj)\n    pickBufferIds.push(-1)\n    dirty = true\n    pickDirty = true\n    reallocPickIds()\n  }\n\n  scene.remove = function(obj) {\n    if(stopped) {\n      return\n    }\n    var idx = objects.indexOf(obj)\n    if(idx < 0) {\n      return\n    }\n    objects.splice(idx, 1)\n    pickBufferIds.pop()\n    dirty = true\n    pickDirty = true\n    reallocPickIds()\n  }\n\n  scene.dispose = function() {\n    if(stopped) {\n      return\n    }\n\n    stopped = true\n\n    window.removeEventListener('resize', resizeListener)\n    canvas.removeEventListener('webglcontextlost', checkContextLoss)\n    scene.mouseListener.enabled = false\n\n    if(scene.contextLost) {\n      return\n    }\n\n    //Destroy objects\n    axes.dispose()\n    spikes.dispose()\n    for(var i=0; i<objects.length; ++i) {\n      objects[i].dispose()\n    }\n\n    //Clean up buffers\n    accumBuffer.dispose()\n    for(var i=0; i<pickBuffers.length; ++i) {\n      pickBuffers[i].dispose()\n    }\n\n    //Clean up shaders\n    accumShader.dispose()\n\n    //Release all references\n    gl = null\n    axes = null\n    spikes = null\n    objects = []\n  }\n\n  //Update mouse position\n  var mouseRotating = false\n\n  var prevButtons = 0\n\n  scene.mouseListener = mouseChange(canvas, function(buttons, x, y) {\n    if(stopped) {\n      return\n    }\n\n    var numPick = pickBuffers.length\n    var numObjs = objects.length\n    var prevObj = selection.object\n\n    selection.distance = Infinity\n    selection.mouse[0] = x\n    selection.mouse[1] = y\n    selection.object = null\n    selection.screen = null\n    selection.dataCoordinate = selection.dataPosition = null\n\n    var change = false\n\n    if(buttons && prevButtons) {\n      mouseRotating = true\n    } else {\n      if(mouseRotating) {\n        pickDirty = true\n      }\n      mouseRotating = false\n\n      for(var i=0; i<numPick; ++i) {\n        var result = pickBuffers[i].query(x, pickShape[1] - y - 1, scene.pickRadius)\n        if(result) {\n          if(result.distance > selection.distance) {\n            continue\n          }\n          for(var j=0; j<numObjs; ++j) {\n            var obj = objects[j]\n            if(pickBufferIds[j] !== i) {\n              continue\n            }\n            var objPick = obj.pick(result)\n            if(objPick) {\n              selection.buttons        = buttons\n              selection.screen         = result.coord\n              selection.distance       = result.distance\n              selection.object         = obj\n              selection.index          = objPick.distance\n              selection.dataPosition   = objPick.position\n              selection.dataCoordinate = objPick.dataCoordinate\n              selection.data           = objPick\n              change = true\n            }\n          }\n        }\n      }\n    }\n\n    if(prevObj && prevObj !== selection.object) {\n      if(prevObj.highlight) {\n        prevObj.highlight(null)\n      }\n      dirty = true\n    }\n    if(selection.object) {\n      if(selection.object.highlight) {\n        selection.object.highlight(selection.data)\n      }\n      dirty = true\n    }\n\n    change = change || (selection.object !== prevObj)\n    if(change && scene.onselect) {\n      scene.onselect(selection)\n    }\n\n    if((buttons & 1) && !(prevButtons & 1) && scene.onclick) {\n      scene.onclick(selection)\n    }\n    prevButtons = buttons\n  })\n\n  function checkContextLoss() {\n    if(scene.contextLost) {\n      return true\n    }\n    if(gl.isContextLost()) {\n      scene.contextLost = true\n      scene.mouseListener.enabled = false\n      scene.selection.object = null\n      if(scene.oncontextloss) {\n        scene.oncontextloss()\n      }\n    }\n  }\n\n  canvas.addEventListener('webglcontextlost', checkContextLoss)\n\n  //Render the scene for mouse picking\n  function renderPick() {\n    if(checkContextLoss()) {\n      return\n    }\n\n    gl.colorMask(true, true, true, true)\n    gl.depthMask(true)\n    gl.disable(gl.BLEND)\n    gl.enable(gl.DEPTH_TEST)\n\n    var numObjs = objects.length\n    var numPick = pickBuffers.length\n    for(var j=0; j<numPick; ++j) {\n      var buf = pickBuffers[j]\n      buf.shape = pickShape\n      buf.begin()\n      for(var i=0; i<numObjs; ++i) {\n        if(pickBufferIds[i] !== j) {\n          continue\n        }\n        var obj = objects[i]\n        if(obj.drawPick) {\n          obj.pixelRatio = 1\n          obj.drawPick(cameraParams)\n        }\n      }\n      buf.end()\n    }\n  }\n\n  var nBounds = [\n    [ Infinity, Infinity, Infinity],\n    [-Infinity,-Infinity,-Infinity]]\n\n  var prevBounds = [nBounds[0].slice(), nBounds[1].slice()]\n\n  function redraw() {\n    if(checkContextLoss()) {\n      return\n    }\n\n    resizeListener()\n\n    //Tick camera\n    var cameraMoved = scene.camera.tick()\n    cameraParams.view = scene.camera.matrix\n    dirty     = dirty || cameraMoved\n    pickDirty = pickDirty || cameraMoved\n\n      //Set pixel ratio\n    axes.pixelRatio   = scene.pixelRatio\n    spikes.pixelRatio = scene.pixelRatio\n\n    //Check if any objects changed, recalculate bounds\n    var numObjs = objects.length\n    var lo = nBounds[0]\n    var hi = nBounds[1]\n    lo[0] = lo[1] = lo[2] =  Infinity\n    hi[0] = hi[1] = hi[2] = -Infinity\n    for(var i=0; i<numObjs; ++i) {\n      var obj = objects[i]\n\n      //Set the axes properties for each object\n      obj.pixelRatio = scene.pixelRatio\n      obj.axes = scene.axes\n\n      dirty = dirty || !!obj.dirty\n      pickDirty = pickDirty || !!obj.dirty\n      var obb = obj.bounds\n      if(obb) {\n        var olo = obb[0]\n        var ohi = obb[1]\n        for(var j=0; j<3; ++j) {\n          lo[j] = Math.min(lo[j], olo[j])\n          hi[j] = Math.max(hi[j], ohi[j])\n        }\n      }\n    }\n\n    //Recalculate bounds\n    var bounds = scene.bounds\n    if(scene.autoBounds) {\n      for(var j=0; j<3; ++j) {\n        if(hi[j] < lo[j]) {\n          lo[j] = -1\n          hi[j] = 1\n        } else {\n          if(lo[j] === hi[j]) {\n            lo[j] -= 1\n            hi[j] += 1\n          }\n          var padding = 0.05 * (hi[j] - lo[j])\n          lo[j] = lo[j] - padding\n          hi[j] = hi[j] + padding\n        }\n        bounds[0][j] = lo[j]\n        bounds[1][j] = hi[j]\n      }\n    }\n\n    var boundsChanged = false\n    for(var j=0; j<3; ++j) {\n        boundsChanged = boundsChanged ||\n            (prevBounds[0][j] !== bounds[0][j])  ||\n            (prevBounds[1][j] !== bounds[1][j])\n        prevBounds[0][j] = bounds[0][j]\n        prevBounds[1][j] = bounds[1][j]\n    }\n\n    //Recalculate bounds\n    pickDirty = pickDirty || boundsChanged\n    dirty = dirty || boundsChanged\n\n    if(!dirty) {\n      return\n    }\n\n    if(boundsChanged) {\n      var tickSpacing = [0,0,0]\n      for(var i=0; i<3; ++i) {\n        tickSpacing[i] = roundUpPow10((bounds[1][i]-bounds[0][i]) / 10.0)\n      }\n      if(axes.autoTicks) {\n        axes.update({\n          bounds: bounds,\n          tickSpacing: tickSpacing\n        })\n      } else {\n        axes.update({\n          bounds: bounds\n        })\n      }\n    }\n\n    //Get scene\n    var width  = gl.drawingBufferWidth\n    var height = gl.drawingBufferHeight\n    viewShape[0] = width\n    viewShape[1] = height\n    pickShape[0] = Math.max(width/scene.pixelRatio, 1)|0\n    pickShape[1] = Math.max(height/scene.pixelRatio, 1)|0\n\n    //Compute camera parameters\n    perspective(projection,\n      scene.fovy,\n      width/height,\n      scene.zNear,\n      scene.zFar)\n\n    //Compute model matrix\n    for(var i=0; i<16; ++i) {\n      model[i] = 0\n    }\n    model[15] = 1\n\n    var maxS = 0\n    for(var i=0; i<3; ++i) {\n      maxS = Math.max(maxS, bounds[1][i] - bounds[0][i])\n    }\n\n    for(var i=0; i<3; ++i) {\n      if(scene.autoScale) {\n        model[5*i] = scene.aspect[i] / (bounds[1][i] - bounds[0][i])\n      } else {\n        model[5*i] = 1  / maxS\n      }\n      if(scene.autoCenter) {\n        model[12+i] = -model[5*i] * 0.5 * (bounds[0][i] + bounds[1][i])\n      }\n    }\n\n    //Apply axes/clip bounds\n    for(var i=0; i<numObjs; ++i) {\n      var obj = objects[i]\n\n      //Set axes bounds\n      obj.axesBounds = bounds\n\n      //Set clip bounds\n      if(scene.clipToBounds) {\n        obj.clipBounds = bounds\n      }\n    }\n    //Set spike parameters\n    if(selection.object) {\n      if(scene.snapToData) {\n        spikes.position = selection.dataCoordinate\n      } else {\n        spikes.position = selection.dataPosition\n      }\n      spikes.bounds = bounds\n    }\n\n    //If state changed, then redraw pick buffers\n    if(pickDirty) {\n      pickDirty = false\n      renderPick()\n    }\n\n    //Recalculate pixel data\n    scene.axesPixels = axesRanges(scene.axes, cameraParams, width, height)\n\n    //Call render callback\n    if(scene.onrender) {\n      scene.onrender()\n    }\n\n    //Read value\n    gl.bindFramebuffer(gl.FRAMEBUFFER, null)\n    gl.viewport(0, 0, width, height)\n\n    //General strategy: 3 steps\n    //  1. render non-transparent objects\n    //  2. accumulate transparent objects into separate fbo\n    //  3. composite final scene\n\n    //Clear FBO\n    var clearColor = scene.clearColor\n    gl.clearColor(clearColor[0], clearColor[1], clearColor[2], clearColor[3])\n    gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT)\n    gl.depthMask(true)\n    gl.colorMask(true, true, true, true)\n    gl.enable(gl.DEPTH_TEST)\n    gl.depthFunc(gl.LEQUAL)\n    gl.disable(gl.BLEND)\n    gl.disable(gl.CULL_FACE)  //most visualization surfaces are 2 sided\n\n    //Render opaque pass\n    var hasTransparent = false\n    if(axes.enable) {\n      hasTransparent = hasTransparent || axes.isTransparent()\n      axes.draw(cameraParams)\n    }\n    spikes.axes = axes\n    if(selection.object) {\n      spikes.draw(cameraParams)\n    }\n\n    gl.disable(gl.CULL_FACE)  //most visualization surfaces are 2 sided\n\n    for(var i=0; i<numObjs; ++i) {\n      var obj = objects[i]\n      obj.axes = axes\n      obj.pixelRatio = scene.pixelRatio\n      if(obj.isOpaque && obj.isOpaque()) {\n        obj.draw(cameraParams)\n      }\n      if(obj.isTransparent && obj.isTransparent()) {\n        hasTransparent = true\n      }\n    }\n\n    if(hasTransparent) {\n      //Render transparent pass\n      accumBuffer.shape = viewShape\n      accumBuffer.bind()\n      gl.clear(gl.DEPTH_BUFFER_BIT)\n      gl.colorMask(false, false, false, false)\n      gl.depthMask(true)\n      gl.depthFunc(gl.LESS)\n\n      //Render forward facing objects\n      if(axes.enable && axes.isTransparent()) {\n        axes.drawTransparent(cameraParams)\n      }\n      for(var i=0; i<numObjs; ++i) {\n        var obj = objects[i]\n        if(obj.isOpaque && obj.isOpaque()) {\n          obj.draw(cameraParams)\n        }\n      }\n\n      //Render transparent pass\n      gl.enable(gl.BLEND)\n      gl.blendEquation(gl.FUNC_ADD)\n      gl.blendFunc(gl.ONE, gl.ONE_MINUS_SRC_ALPHA)\n      gl.colorMask(true, true, true, true)\n      gl.depthMask(false)\n      gl.clearColor(0,0,0,0)\n      gl.clear(gl.COLOR_BUFFER_BIT)\n\n      if(axes.isTransparent()) {\n        axes.drawTransparent(cameraParams)\n      }\n\n      for(var i=0; i<numObjs; ++i) {\n        var obj = objects[i]\n        if(obj.isTransparent && obj.isTransparent()) {\n          obj.drawTransparent(cameraParams)\n        }\n      }\n\n      //Unbind framebuffer\n      gl.bindFramebuffer(gl.FRAMEBUFFER, null)\n\n      //Draw composite pass\n      gl.blendFunc(gl.ONE, gl.ONE_MINUS_SRC_ALPHA)\n      gl.disable(gl.DEPTH_TEST)\n      accumShader.bind()\n      accumBuffer.color[0].bind(0)\n      accumShader.uniforms.accumBuffer = 0\n      drawTriangle(gl)\n\n      //Turn off blending\n      gl.disable(gl.BLEND)\n    }\n\n    //Clear dirty flags\n    dirty = false\n    for(var i=0; i<numObjs; ++i) {\n      objects[i].dirty = false\n    }\n  }\n\n\n  //Draw the whole scene\n  function render() {\n    if(stopped || scene.contextLost) {\n      return\n    }\n    // this order is important: ios safari sometimes has sync raf\n    redraw()\n    requestAnimationFrame(render)\n  }\n  render()\n\n  //Force redraw of whole scene\n  scene.redraw = function() {\n    if(stopped) {\n      return\n    }\n    dirty = true\n    redraw()\n  }\n\n  return scene\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}