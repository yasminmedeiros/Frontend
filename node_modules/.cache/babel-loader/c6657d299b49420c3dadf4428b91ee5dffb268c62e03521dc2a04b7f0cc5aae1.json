{"ast":null,"code":"/**\n* Copyright 2012-2019, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n\n'use strict';\n\nvar c = require('./constants');\nvar d3 = require('d3');\nvar gup = require('../../lib/gup');\nvar Drawing = require('../../components/drawing');\nvar svgUtil = require('../../lib/svg_text_utils');\nvar raiseToTop = require('../../lib').raiseToTop;\nvar cancelEeaseColumn = require('../../lib').cancelTransition;\nvar prepareData = require('./data_preparation_helper');\nvar splitData = require('./data_split_helpers');\nvar Color = require('../../components/color');\nmodule.exports = function plot(gd, wrappedTraceHolders) {\n  var dynamic = !gd._context.staticPlot;\n  var table = gd._fullLayout._paper.selectAll('.' + c.cn.table).data(wrappedTraceHolders.map(function (wrappedTraceHolder) {\n    var traceHolder = gup.unwrap(wrappedTraceHolder);\n    var trace = traceHolder.trace;\n    return prepareData(gd, trace);\n  }), gup.keyFun);\n  table.exit().remove();\n  table.enter().append('g').classed(c.cn.table, true).attr('overflow', 'visible').style('box-sizing', 'content-box').style('position', 'absolute').style('left', 0).style('overflow', 'visible').style('shape-rendering', 'crispEdges').style('pointer-events', 'all');\n  table.attr('width', function (d) {\n    return d.width + d.size.l + d.size.r;\n  }).attr('height', function (d) {\n    return d.height + d.size.t + d.size.b;\n  }).attr('transform', function (d) {\n    return 'translate(' + d.translateX + ',' + d.translateY + ')';\n  });\n  var tableControlView = table.selectAll('.' + c.cn.tableControlView).data(gup.repeat, gup.keyFun);\n  var cvEnter = tableControlView.enter().append('g').classed(c.cn.tableControlView, true).style('box-sizing', 'content-box');\n  if (dynamic) {\n    cvEnter.on('mousemove', function (d) {\n      tableControlView.filter(function (dd) {\n        return d === dd;\n      }).call(renderScrollbarKit, gd);\n    }).on('mousewheel', function (d) {\n      if (d.scrollbarState.wheeling) return;\n      d.scrollbarState.wheeling = true;\n      var newY = d.scrollY + d3.event.deltaY;\n      var noChange = makeDragRow(gd, tableControlView, null, newY)(d);\n      if (!noChange) {\n        d3.event.stopPropagation();\n        d3.event.preventDefault();\n      }\n      d.scrollbarState.wheeling = false;\n    }).call(renderScrollbarKit, gd, true);\n  }\n  tableControlView.attr('transform', function (d) {\n    return 'translate(' + d.size.l + ' ' + d.size.t + ')';\n  });\n\n  // scrollBackground merely ensures that mouse events are captured even on crazy fast scrollwheeling\n  // otherwise rendering glitches may occur\n  var scrollBackground = tableControlView.selectAll('.' + c.cn.scrollBackground).data(gup.repeat, gup.keyFun);\n  scrollBackground.enter().append('rect').classed(c.cn.scrollBackground, true).attr('fill', 'none');\n  scrollBackground.attr('width', function (d) {\n    return d.width;\n  }).attr('height', function (d) {\n    return d.height;\n  });\n  tableControlView.each(function (d) {\n    Drawing.setClipUrl(d3.select(this), scrollAreaBottomClipKey(gd, d), gd);\n  });\n  var yColumn = tableControlView.selectAll('.' + c.cn.yColumn).data(function (vm) {\n    return vm.columns;\n  }, gup.keyFun);\n  yColumn.enter().append('g').classed(c.cn.yColumn, true);\n  yColumn.exit().remove();\n  yColumn.attr('transform', function (d) {\n    return 'translate(' + d.x + ' 0)';\n  });\n  if (dynamic) {\n    yColumn.call(d3.behavior.drag().origin(function (d) {\n      var movedColumn = d3.select(this);\n      easeColumn(movedColumn, d, -c.uplift);\n      raiseToTop(this);\n      d.calcdata.columnDragInProgress = true;\n      renderScrollbarKit(tableControlView.filter(function (dd) {\n        return d.calcdata.key === dd.key;\n      }), gd);\n      return d;\n    }).on('drag', function (d) {\n      var movedColumn = d3.select(this);\n      var getter = function getter(dd) {\n        return (d === dd ? d3.event.x : dd.x) + dd.columnWidth / 2;\n      };\n      d.x = Math.max(-c.overdrag, Math.min(d.calcdata.width + c.overdrag - d.columnWidth, d3.event.x));\n      var sortableColumns = flatData(yColumn).filter(function (dd) {\n        return dd.calcdata.key === d.calcdata.key;\n      });\n      var newOrder = sortableColumns.sort(function (a, b) {\n        return getter(a) - getter(b);\n      });\n      newOrder.forEach(function (dd, i) {\n        dd.xIndex = i;\n        dd.x = d === dd ? dd.x : dd.xScale(dd);\n      });\n      yColumn.filter(function (dd) {\n        return d !== dd;\n      }).transition().ease(c.transitionEase).duration(c.transitionDuration).attr('transform', function (d) {\n        return 'translate(' + d.x + ' 0)';\n      });\n      movedColumn.call(cancelEeaseColumn).attr('transform', 'translate(' + d.x + ' -' + c.uplift + ' )');\n    }).on('dragend', function (d) {\n      var movedColumn = d3.select(this);\n      var p = d.calcdata;\n      d.x = d.xScale(d);\n      d.calcdata.columnDragInProgress = false;\n      easeColumn(movedColumn, d, 0);\n      columnMoved(gd, p, p.columns.map(function (dd) {\n        return dd.xIndex;\n      }));\n    }));\n  }\n  yColumn.each(function (d) {\n    Drawing.setClipUrl(d3.select(this), columnBoundaryClipKey(gd, d), gd);\n  });\n  var columnBlock = yColumn.selectAll('.' + c.cn.columnBlock).data(splitData.splitToPanels, gup.keyFun);\n  columnBlock.enter().append('g').classed(c.cn.columnBlock, true).attr('id', function (d) {\n    return d.key;\n  });\n  columnBlock.style('cursor', function (d) {\n    return d.dragHandle ? 'ew-resize' : d.calcdata.scrollbarState.barWiggleRoom ? 'ns-resize' : 'default';\n  });\n  var headerColumnBlock = columnBlock.filter(headerBlock);\n  var cellsColumnBlock = columnBlock.filter(cellsBlock);\n  if (dynamic) {\n    cellsColumnBlock.call(d3.behavior.drag().origin(function (d) {\n      d3.event.stopPropagation();\n      return d;\n    }).on('drag', makeDragRow(gd, tableControlView, -1)).on('dragend', function () {\n      // fixme emit plotly notification\n    }));\n  }\n\n  // initial rendering: header is rendered first, as it may may have async LaTeX (show header first)\n  // but blocks are _entered_ the way they are due to painter's algo (header on top)\n  renderColumnCellTree(gd, tableControlView, headerColumnBlock, columnBlock);\n  renderColumnCellTree(gd, tableControlView, cellsColumnBlock, columnBlock);\n  var scrollAreaClip = tableControlView.selectAll('.' + c.cn.scrollAreaClip).data(gup.repeat, gup.keyFun);\n  scrollAreaClip.enter().append('clipPath').classed(c.cn.scrollAreaClip, true).attr('id', function (d) {\n    return scrollAreaBottomClipKey(gd, d);\n  });\n  var scrollAreaClipRect = scrollAreaClip.selectAll('.' + c.cn.scrollAreaClipRect).data(gup.repeat, gup.keyFun);\n  scrollAreaClipRect.enter().append('rect').classed(c.cn.scrollAreaClipRect, true).attr('x', -c.overdrag).attr('y', -c.uplift).attr('fill', 'none');\n  scrollAreaClipRect.attr('width', function (d) {\n    return d.width + 2 * c.overdrag;\n  }).attr('height', function (d) {\n    return d.height + c.uplift;\n  });\n  var columnBoundary = yColumn.selectAll('.' + c.cn.columnBoundary).data(gup.repeat, gup.keyFun);\n  columnBoundary.enter().append('g').classed(c.cn.columnBoundary, true);\n  var columnBoundaryClippath = yColumn.selectAll('.' + c.cn.columnBoundaryClippath).data(gup.repeat, gup.keyFun);\n\n  // SVG spec doesn't mandate wrapping into a <defs> and doesn't seem to cause a speed difference\n  columnBoundaryClippath.enter().append('clipPath').classed(c.cn.columnBoundaryClippath, true);\n  columnBoundaryClippath.attr('id', function (d) {\n    return columnBoundaryClipKey(gd, d);\n  });\n  var columnBoundaryRect = columnBoundaryClippath.selectAll('.' + c.cn.columnBoundaryRect).data(gup.repeat, gup.keyFun);\n  columnBoundaryRect.enter().append('rect').classed(c.cn.columnBoundaryRect, true).attr('fill', 'none');\n  columnBoundaryRect.attr('width', function (d) {\n    return d.columnWidth + 2 * roundHalfWidth(d);\n  }).attr('height', function (d) {\n    return d.calcdata.height + 2 * roundHalfWidth(d) + c.uplift;\n  }).attr('x', function (d) {\n    return -roundHalfWidth(d);\n  }).attr('y', function (d) {\n    return -roundHalfWidth(d);\n  });\n  updateBlockYPosition(null, cellsColumnBlock, tableControlView);\n};\nfunction roundHalfWidth(d) {\n  return Math.ceil(d.calcdata.maxLineWidth / 2);\n}\nfunction scrollAreaBottomClipKey(gd, d) {\n  return 'clip' + gd._fullLayout._uid + '_scrollAreaBottomClip_' + d.key;\n}\nfunction columnBoundaryClipKey(gd, d) {\n  return 'clip' + gd._fullLayout._uid + '_columnBoundaryClippath_' + d.calcdata.key + '_' + d.specIndex;\n}\nfunction flatData(selection) {\n  return [].concat.apply([], selection.map(function (g) {\n    return g;\n  })).map(function (g) {\n    return g.__data__;\n  });\n}\nfunction renderScrollbarKit(tableControlView, gd, bypassVisibleBar) {\n  function calcTotalHeight(d) {\n    var blocks = d.rowBlocks;\n    return firstRowAnchor(blocks, blocks.length - 1) + (blocks.length ? rowsHeight(blocks[blocks.length - 1], Infinity) : 1);\n  }\n  var scrollbarKit = tableControlView.selectAll('.' + c.cn.scrollbarKit).data(gup.repeat, gup.keyFun);\n  scrollbarKit.enter().append('g').classed(c.cn.scrollbarKit, true).style('shape-rendering', 'geometricPrecision');\n  scrollbarKit.each(function (d) {\n    var s = d.scrollbarState;\n    s.totalHeight = calcTotalHeight(d);\n    s.scrollableAreaHeight = d.groupHeight - headerHeight(d);\n    s.currentlyVisibleHeight = Math.min(s.totalHeight, s.scrollableAreaHeight);\n    s.ratio = s.currentlyVisibleHeight / s.totalHeight;\n    s.barLength = Math.max(s.ratio * s.currentlyVisibleHeight, c.goldenRatio * c.scrollbarWidth);\n    s.barWiggleRoom = s.currentlyVisibleHeight - s.barLength;\n    s.wiggleRoom = Math.max(0, s.totalHeight - s.scrollableAreaHeight);\n    s.topY = s.barWiggleRoom === 0 ? 0 : d.scrollY / s.wiggleRoom * s.barWiggleRoom;\n    s.bottomY = s.topY + s.barLength;\n    s.dragMultiplier = s.wiggleRoom / s.barWiggleRoom;\n  }).attr('transform', function (d) {\n    var xPosition = d.width + c.scrollbarWidth / 2 + c.scrollbarOffset;\n    return 'translate(' + xPosition + ' ' + headerHeight(d) + ')';\n  });\n  var scrollbar = scrollbarKit.selectAll('.' + c.cn.scrollbar).data(gup.repeat, gup.keyFun);\n  scrollbar.enter().append('g').classed(c.cn.scrollbar, true);\n  var scrollbarSlider = scrollbar.selectAll('.' + c.cn.scrollbarSlider).data(gup.repeat, gup.keyFun);\n  scrollbarSlider.enter().append('g').classed(c.cn.scrollbarSlider, true);\n  scrollbarSlider.attr('transform', function (d) {\n    return 'translate(0 ' + (d.scrollbarState.topY || 0) + ')';\n  });\n  var scrollbarGlyph = scrollbarSlider.selectAll('.' + c.cn.scrollbarGlyph).data(gup.repeat, gup.keyFun);\n  scrollbarGlyph.enter().append('line').classed(c.cn.scrollbarGlyph, true).attr('stroke', 'black').attr('stroke-width', c.scrollbarWidth).attr('stroke-linecap', 'round').attr('y1', c.scrollbarWidth / 2);\n  scrollbarGlyph.attr('y2', function (d) {\n    return d.scrollbarState.barLength - c.scrollbarWidth / 2;\n  }).attr('stroke-opacity', function (d) {\n    return d.columnDragInProgress || !d.scrollbarState.barWiggleRoom || bypassVisibleBar ? 0 : 0.4;\n  });\n\n  // cancel transition: possible pending (also, delayed) transition\n  scrollbarGlyph.transition().delay(0).duration(0);\n  scrollbarGlyph.transition().delay(c.scrollbarHideDelay).duration(c.scrollbarHideDuration).attr('stroke-opacity', 0);\n  var scrollbarCaptureZone = scrollbar.selectAll('.' + c.cn.scrollbarCaptureZone).data(gup.repeat, gup.keyFun);\n  scrollbarCaptureZone.enter().append('line').classed(c.cn.scrollbarCaptureZone, true).attr('stroke', 'white').attr('stroke-opacity', 0.01) // some browser might get rid of a 0 opacity element\n  .attr('stroke-width', c.scrollbarCaptureWidth).attr('stroke-linecap', 'butt').attr('y1', 0).on('mousedown', function (d) {\n    var y = d3.event.y;\n    var bbox = this.getBoundingClientRect();\n    var s = d.scrollbarState;\n    var pixelVal = y - bbox.top;\n    var inverseScale = d3.scale.linear().domain([0, s.scrollableAreaHeight]).range([0, s.totalHeight]).clamp(true);\n    if (!(s.topY <= pixelVal && pixelVal <= s.bottomY)) {\n      makeDragRow(gd, tableControlView, null, inverseScale(pixelVal - s.barLength / 2))(d);\n    }\n  }).call(d3.behavior.drag().origin(function (d) {\n    d3.event.stopPropagation();\n    d.scrollbarState.scrollbarScrollInProgress = true;\n    return d;\n  }).on('drag', makeDragRow(gd, tableControlView)).on('dragend', function () {\n    // fixme emit Plotly event\n  }));\n  scrollbarCaptureZone.attr('y2', function (d) {\n    return d.scrollbarState.scrollableAreaHeight;\n  });\n\n  // Remove scroll glyph and capture zone on static plots\n  // as they don't render properly when converted to PDF\n  // in the Chrome PDF viewer\n  // https://github.com/plotly/streambed/issues/11618\n  if (gd._context.staticPlot) {\n    scrollbarGlyph.remove();\n    scrollbarCaptureZone.remove();\n  }\n}\nfunction renderColumnCellTree(gd, tableControlView, columnBlock, allColumnBlock) {\n  // fixme this perf hotspot\n  // this is performance critical code as scrolling calls it on every revolver switch\n  // it appears sufficiently fast but there are plenty of low-hanging fruits for performance optimization\n\n  var columnCells = renderColumnCells(columnBlock);\n  var columnCell = renderColumnCell(columnCells);\n  supplyStylingValues(columnCell);\n  var cellRect = renderCellRect(columnCell);\n  sizeAndStyleRect(cellRect);\n  var cellTextHolder = renderCellTextHolder(columnCell);\n  var cellText = renderCellText(cellTextHolder);\n  setFont(cellText);\n  populateCellText(cellText, tableControlView, allColumnBlock, gd);\n\n  // doing this at the end when text, and text stlying are set\n  setCellHeightAndPositionY(columnCell);\n}\nfunction renderColumnCells(columnBlock) {\n  var columnCells = columnBlock.selectAll('.' + c.cn.columnCells).data(gup.repeat, gup.keyFun);\n  columnCells.enter().append('g').classed(c.cn.columnCells, true);\n  columnCells.exit().remove();\n  return columnCells;\n}\nfunction renderColumnCell(columnCells) {\n  var columnCell = columnCells.selectAll('.' + c.cn.columnCell).data(splitData.splitToCells, function (d) {\n    return d.keyWithinBlock;\n  });\n  columnCell.enter().append('g').classed(c.cn.columnCell, true);\n  columnCell.exit().remove();\n  return columnCell;\n}\nfunction renderCellRect(columnCell) {\n  var cellRect = columnCell.selectAll('.' + c.cn.cellRect).data(gup.repeat, function (d) {\n    return d.keyWithinBlock;\n  });\n  cellRect.enter().append('rect').classed(c.cn.cellRect, true);\n  return cellRect;\n}\nfunction renderCellText(cellTextHolder) {\n  var cellText = cellTextHolder.selectAll('.' + c.cn.cellText).data(gup.repeat, function (d) {\n    return d.keyWithinBlock;\n  });\n  cellText.enter().append('text').classed(c.cn.cellText, true).style('cursor', function () {\n    return 'auto';\n  }).on('mousedown', function () {\n    d3.event.stopPropagation();\n  });\n  return cellText;\n}\nfunction renderCellTextHolder(columnCell) {\n  var cellTextHolder = columnCell.selectAll('.' + c.cn.cellTextHolder).data(gup.repeat, function (d) {\n    return d.keyWithinBlock;\n  });\n  cellTextHolder.enter().append('g').classed(c.cn.cellTextHolder, true).style('shape-rendering', 'geometricPrecision');\n  return cellTextHolder;\n}\nfunction supplyStylingValues(columnCell) {\n  columnCell.each(function (d, i) {\n    var spec = d.calcdata.cells.font;\n    var col = d.column.specIndex;\n    var font = {\n      size: gridPick(spec.size, col, i),\n      color: gridPick(spec.color, col, i),\n      family: gridPick(spec.family, col, i)\n    };\n    d.rowNumber = d.key;\n    d.align = gridPick(d.calcdata.cells.align, col, i);\n    d.cellBorderWidth = gridPick(d.calcdata.cells.line.width, col, i);\n    d.font = font;\n  });\n}\nfunction setFont(cellText) {\n  cellText.each(function (d) {\n    Drawing.font(d3.select(this), d.font);\n  });\n}\nfunction sizeAndStyleRect(cellRect) {\n  cellRect.attr('width', function (d) {\n    return d.column.columnWidth;\n  }).attr('stroke-width', function (d) {\n    return d.cellBorderWidth;\n  }).each(function (d) {\n    var atomicSelection = d3.select(this);\n    Color.stroke(atomicSelection, gridPick(d.calcdata.cells.line.color, d.column.specIndex, d.rowNumber));\n    Color.fill(atomicSelection, gridPick(d.calcdata.cells.fill.color, d.column.specIndex, d.rowNumber));\n  });\n}\nfunction populateCellText(cellText, tableControlView, allColumnBlock, gd) {\n  cellText.text(function (d) {\n    var col = d.column.specIndex;\n    var row = d.rowNumber;\n    var userSuppliedContent = d.value;\n    var stringSupplied = typeof userSuppliedContent === 'string';\n    var hasBreaks = stringSupplied && userSuppliedContent.match(/<br>/i);\n    var userBrokenText = !stringSupplied || hasBreaks;\n    d.mayHaveMarkup = stringSupplied && userSuppliedContent.match(/[<&>]/);\n    var latex = isLatex(userSuppliedContent);\n    d.latex = latex;\n    var prefix = latex ? '' : gridPick(d.calcdata.cells.prefix, col, row) || '';\n    var suffix = latex ? '' : gridPick(d.calcdata.cells.suffix, col, row) || '';\n    var format = latex ? null : gridPick(d.calcdata.cells.format, col, row) || null;\n    var prefixSuffixedText = prefix + (format ? d3.format(format)(d.value) : d.value) + suffix;\n    var hasWrapSplitCharacter;\n    d.wrappingNeeded = !d.wrapped && !userBrokenText && !latex && (hasWrapSplitCharacter = hasWrapCharacter(prefixSuffixedText));\n    d.cellHeightMayIncrease = hasBreaks || latex || d.mayHaveMarkup || (hasWrapSplitCharacter === void 0 ? hasWrapCharacter(prefixSuffixedText) : hasWrapSplitCharacter);\n    d.needsConvertToTspans = d.mayHaveMarkup || d.wrappingNeeded || d.latex;\n    var textToRender;\n    if (d.wrappingNeeded) {\n      var hrefPreservedText = c.wrapSplitCharacter === ' ' ? prefixSuffixedText.replace(/<a href=/ig, '<a_href=') : prefixSuffixedText;\n      var fragments = hrefPreservedText.split(c.wrapSplitCharacter);\n      var hrefRestoredFragments = c.wrapSplitCharacter === ' ' ? fragments.map(function (frag) {\n        return frag.replace(/<a_href=/ig, '<a href=');\n      }) : fragments;\n      d.fragments = hrefRestoredFragments.map(function (f) {\n        return {\n          text: f,\n          width: null\n        };\n      });\n      d.fragments.push({\n        fragment: c.wrapSpacer,\n        width: null\n      });\n      textToRender = hrefRestoredFragments.join(c.lineBreaker) + c.lineBreaker + c.wrapSpacer;\n    } else {\n      delete d.fragments;\n      textToRender = prefixSuffixedText;\n    }\n    return textToRender;\n  }).attr('dy', function (d) {\n    return d.needsConvertToTspans ? 0 : '0.75em';\n  }).each(function (d) {\n    var element = this;\n    var selection = d3.select(element);\n\n    // finalize what's in the DOM\n\n    var renderCallback = d.wrappingNeeded ? wrapTextMaker : updateYPositionMaker;\n    if (d.needsConvertToTspans) {\n      svgUtil.convertToTspans(selection, gd, renderCallback(allColumnBlock, element, tableControlView, gd, d));\n    } else {\n      d3.select(element.parentNode)\n      // basic cell adjustment - compliance with `cellPad`\n      .attr('transform', function (d) {\n        return 'translate(' + xPosition(d) + ' ' + c.cellPad + ')';\n      }).attr('text-anchor', function (d) {\n        return {\n          left: 'start',\n          center: 'middle',\n          right: 'end'\n        }[d.align];\n      });\n    }\n  });\n}\nfunction isLatex(content) {\n  return typeof content === 'string' && content.match(c.latexCheck);\n}\nfunction hasWrapCharacter(text) {\n  return text.indexOf(c.wrapSplitCharacter) !== -1;\n}\nfunction columnMoved(gd, calcdata, indices) {\n  var o = calcdata.gdColumnsOriginalOrder;\n  calcdata.gdColumns.sort(function (a, b) {\n    return indices[o.indexOf(a)] - indices[o.indexOf(b)];\n  });\n  calcdata.columnorder = indices;\n\n  // TODO: there's no data here, but also this reordering is not reflected\n  // in gd.data or even gd._fullData.\n  // For now I will not attempt to persist this in _preGUI\n  gd.emit('plotly_restyle');\n}\nfunction gridPick(spec, col, row) {\n  if (Array.isArray(spec)) {\n    var column = spec[Math.min(col, spec.length - 1)];\n    if (Array.isArray(column)) {\n      return column[Math.min(row, column.length - 1)];\n    } else {\n      return column;\n    }\n  } else {\n    return spec;\n  }\n}\nfunction easeColumn(selection, d, y) {\n  selection.transition().ease(c.releaseTransitionEase).duration(c.releaseTransitionDuration).attr('transform', 'translate(' + d.x + ' ' + y + ')');\n}\nfunction cellsBlock(d) {\n  return d.type === 'cells';\n}\nfunction headerBlock(d) {\n  return d.type === 'header';\n}\n\n/**\n * Revolver panel and cell contents layouting\n */\n\nfunction headerHeight(d) {\n  var headerBlocks = d.rowBlocks.length ? d.rowBlocks[0].auxiliaryBlocks : [];\n  return headerBlocks.reduce(function (p, n) {\n    return p + rowsHeight(n, Infinity);\n  }, 0);\n}\nfunction findPagesAndCacheHeights(blocks, scrollY, scrollHeight) {\n  var pages = [];\n  var pTop = 0;\n  for (var blockIndex = 0; blockIndex < blocks.length; blockIndex++) {\n    var block = blocks[blockIndex];\n    var blockRows = block.rows;\n    var rowsHeight = 0;\n    for (var i = 0; i < blockRows.length; i++) {\n      rowsHeight += blockRows[i].rowHeight;\n    }\n\n    // caching allRowsHeight on the block - it's safe as this function is always called from within the code part\n    // that handles increases to row heights\n    block.allRowsHeight = rowsHeight;\n    var pBottom = pTop + rowsHeight;\n    var windowTop = scrollY;\n    var windowBottom = windowTop + scrollHeight;\n    if (windowTop < pBottom && windowBottom > pTop) {\n      pages.push(blockIndex);\n    }\n    pTop += rowsHeight;\n\n    // consider this nice final optimization; put it in `for` condition - caveat, currently the\n    // block.allRowsHeight relies on being invalidated, so enabling this opt may not be safe\n    // if(pages.length > 1) break;\n  }\n\n  return pages;\n}\nfunction updateBlockYPosition(gd, cellsColumnBlock, tableControlView) {\n  var d = flatData(cellsColumnBlock)[0];\n  if (d === undefined) return;\n  var blocks = d.rowBlocks;\n  var calcdata = d.calcdata;\n  var bottom = firstRowAnchor(blocks, blocks.length);\n  var scrollHeight = d.calcdata.groupHeight - headerHeight(d);\n  var scrollY = calcdata.scrollY = Math.max(0, Math.min(bottom - scrollHeight, calcdata.scrollY));\n  var pages = findPagesAndCacheHeights(blocks, scrollY, scrollHeight);\n  if (pages.length === 1) {\n    if (pages[0] === blocks.length - 1) {\n      pages.unshift(pages[0] - 1);\n    } else {\n      pages.push(pages[0] + 1);\n    }\n  }\n\n  // make phased out page jump by 2 while leaving stationary page intact\n  if (pages[0] % 2) {\n    pages.reverse();\n  }\n  cellsColumnBlock.each(function (d, i) {\n    // these values will also be needed when a block is translated again due to growing cell height\n    d.page = pages[i];\n    d.scrollY = scrollY;\n  });\n  cellsColumnBlock.attr('transform', function (d) {\n    var yTranslate = firstRowAnchor(d.rowBlocks, d.page) - d.scrollY;\n    return 'translate(0 ' + yTranslate + ')';\n  });\n\n  // conditionally rerendering panel 0 and 1\n  if (gd) {\n    conditionalPanelRerender(gd, tableControlView, cellsColumnBlock, pages, d.prevPages, d, 0);\n    conditionalPanelRerender(gd, tableControlView, cellsColumnBlock, pages, d.prevPages, d, 1);\n    renderScrollbarKit(tableControlView, gd);\n  }\n}\nfunction makeDragRow(gd, allTableControlView, optionalMultiplier, optionalPosition) {\n  return function dragRow(eventD) {\n    // may come from whichever DOM event target: drag, wheel, bar... eventD corresponds to event target\n    var d = eventD.calcdata ? eventD.calcdata : eventD;\n    var tableControlView = allTableControlView.filter(function (dd) {\n      return d.key === dd.key;\n    });\n    var multiplier = optionalMultiplier || d.scrollbarState.dragMultiplier;\n    var initialScrollY = d.scrollY;\n    d.scrollY = optionalPosition === void 0 ? d.scrollY + multiplier * d3.event.dy : optionalPosition;\n    var cellsColumnBlock = tableControlView.selectAll('.' + c.cn.yColumn).selectAll('.' + c.cn.columnBlock).filter(cellsBlock);\n    updateBlockYPosition(gd, cellsColumnBlock, tableControlView);\n\n    // return false if we've \"used\" the scroll, ie it did something,\n    // so the event shouldn't bubble (if appropriate)\n    return d.scrollY === initialScrollY;\n  };\n}\nfunction conditionalPanelRerender(gd, tableControlView, cellsColumnBlock, pages, prevPages, d, revolverIndex) {\n  var shouldComponentUpdate = pages[revolverIndex] !== prevPages[revolverIndex];\n  if (shouldComponentUpdate) {\n    clearTimeout(d.currentRepaint[revolverIndex]);\n    d.currentRepaint[revolverIndex] = setTimeout(function () {\n      // setTimeout might lag rendering but yields a smoother scroll, because fast scrolling makes\n      // some repaints invisible ie. wasteful (DOM work blocks the main thread)\n      var toRerender = cellsColumnBlock.filter(function (d, i) {\n        return i === revolverIndex && pages[i] !== prevPages[i];\n      });\n      renderColumnCellTree(gd, tableControlView, toRerender, cellsColumnBlock);\n      prevPages[revolverIndex] = pages[revolverIndex];\n    });\n  }\n}\nfunction wrapTextMaker(columnBlock, element, tableControlView, gd) {\n  return function wrapText() {\n    var cellTextHolder = d3.select(element.parentNode);\n    cellTextHolder.each(function (d) {\n      var fragments = d.fragments;\n      cellTextHolder.selectAll('tspan.line').each(function (dd, i) {\n        fragments[i].width = this.getComputedTextLength();\n      });\n      // last element is only for measuring the separator character, so it's ignored:\n      var separatorLength = fragments[fragments.length - 1].width;\n      var rest = fragments.slice(0, -1);\n      var currentRow = [];\n      var currentAddition, currentAdditionLength;\n      var currentRowLength = 0;\n      var rowLengthLimit = d.column.columnWidth - 2 * c.cellPad;\n      d.value = '';\n      while (rest.length) {\n        currentAddition = rest.shift();\n        currentAdditionLength = currentAddition.width + separatorLength;\n        if (currentRowLength + currentAdditionLength > rowLengthLimit) {\n          d.value += currentRow.join(c.wrapSpacer) + c.lineBreaker;\n          currentRow = [];\n          currentRowLength = 0;\n        }\n        currentRow.push(currentAddition.text);\n        currentRowLength += currentAdditionLength;\n      }\n      if (currentRowLength) {\n        d.value += currentRow.join(c.wrapSpacer);\n      }\n      d.wrapped = true;\n    });\n\n    // the pre-wrapped text was rendered only for the text measurements\n    cellTextHolder.selectAll('tspan.line').remove();\n\n    // resupply text, now wrapped\n    populateCellText(cellTextHolder.select('.' + c.cn.cellText), tableControlView, columnBlock, gd);\n    d3.select(element.parentNode.parentNode).call(setCellHeightAndPositionY);\n  };\n}\nfunction updateYPositionMaker(columnBlock, element, tableControlView, gd, d) {\n  return function updateYPosition() {\n    if (d.settledY) return;\n    var cellTextHolder = d3.select(element.parentNode);\n    var l = getBlock(d);\n    var rowIndex = d.key - l.firstRowIndex;\n    var declaredRowHeight = l.rows[rowIndex].rowHeight;\n    var requiredHeight = d.cellHeightMayIncrease ? element.parentNode.getBoundingClientRect().height + 2 * c.cellPad : declaredRowHeight;\n    var finalHeight = Math.max(requiredHeight, declaredRowHeight);\n    var increase = finalHeight - l.rows[rowIndex].rowHeight;\n    if (increase) {\n      // current row height increased\n      l.rows[rowIndex].rowHeight = finalHeight;\n      columnBlock.selectAll('.' + c.cn.columnCell).call(setCellHeightAndPositionY);\n      updateBlockYPosition(null, columnBlock.filter(cellsBlock), 0);\n\n      // if d.column.type === 'header', then the scrollbar has to be pushed downward to the scrollable area\n      // if d.column.type === 'cells', it can still be relevant if total scrolling content height is less than the\n      //                               scrollable window, as increases to row heights may need scrollbar updates\n      renderScrollbarKit(tableControlView, gd, true);\n    }\n    cellTextHolder.attr('transform', function () {\n      // this code block is only invoked for items where d.cellHeightMayIncrease is truthy\n      var element = this;\n      var columnCellElement = element.parentNode;\n      var box = columnCellElement.getBoundingClientRect();\n      var rectBox = d3.select(element.parentNode).select('.' + c.cn.cellRect).node().getBoundingClientRect();\n      var currentTransform = element.transform.baseVal.consolidate();\n      var yPosition = rectBox.top - box.top + (currentTransform ? currentTransform.matrix.f : c.cellPad);\n      return 'translate(' + xPosition(d, d3.select(element.parentNode).select('.' + c.cn.cellTextHolder).node().getBoundingClientRect().width) + ' ' + yPosition + ')';\n    });\n    d.settledY = true;\n  };\n}\nfunction xPosition(d, optionalWidth) {\n  switch (d.align) {\n    case 'left':\n      return c.cellPad;\n    case 'right':\n      return d.column.columnWidth - (optionalWidth || 0) - c.cellPad;\n    case 'center':\n      return (d.column.columnWidth - (optionalWidth || 0)) / 2;\n    default:\n      return c.cellPad;\n  }\n}\nfunction setCellHeightAndPositionY(columnCell) {\n  columnCell.attr('transform', function (d) {\n    var headerHeight = d.rowBlocks[0].auxiliaryBlocks.reduce(function (p, n) {\n      return p + rowsHeight(n, Infinity);\n    }, 0);\n    var l = getBlock(d);\n    var rowAnchor = rowsHeight(l, d.key);\n    var yOffset = rowAnchor + headerHeight;\n    return 'translate(0 ' + yOffset + ')';\n  }).selectAll('.' + c.cn.cellRect).attr('height', function (d) {\n    return getRow(getBlock(d), d.key).rowHeight;\n  });\n}\nfunction firstRowAnchor(blocks, page) {\n  var total = 0;\n  for (var i = page - 1; i >= 0; i--) {\n    total += allRowsHeight(blocks[i]);\n  }\n  return total;\n}\nfunction rowsHeight(rowBlock, key) {\n  var total = 0;\n  for (var i = 0; i < rowBlock.rows.length && rowBlock.rows[i].rowIndex < key; i++) {\n    total += rowBlock.rows[i].rowHeight;\n  }\n  return total;\n}\nfunction allRowsHeight(rowBlock) {\n  var cached = rowBlock.allRowsHeight;\n  if (cached !== void 0) {\n    return cached;\n  }\n  var total = 0;\n  for (var i = 0; i < rowBlock.rows.length; i++) {\n    total += rowBlock.rows[i].rowHeight;\n  }\n  rowBlock.allRowsHeight = total;\n  return total;\n}\nfunction getBlock(d) {\n  return d.rowBlocks[d.page];\n}\nfunction getRow(l, i) {\n  return l.rows[i - l.firstRowIndex];\n}","map":{"version":3,"names":["c","require","d3","gup","Drawing","svgUtil","raiseToTop","cancelEeaseColumn","cancelTransition","prepareData","splitData","Color","module","exports","plot","gd","wrappedTraceHolders","dynamic","_context","staticPlot","table","_fullLayout","_paper","selectAll","cn","data","map","wrappedTraceHolder","traceHolder","unwrap","trace","keyFun","exit","remove","enter","append","classed","attr","style","d","width","size","l","r","height","t","b","translateX","translateY","tableControlView","repeat","cvEnter","on","filter","dd","call","renderScrollbarKit","scrollbarState","wheeling","newY","scrollY","event","deltaY","noChange","makeDragRow","stopPropagation","preventDefault","scrollBackground","each","setClipUrl","select","scrollAreaBottomClipKey","yColumn","vm","columns","x","behavior","drag","origin","movedColumn","easeColumn","uplift","calcdata","columnDragInProgress","key","getter","columnWidth","Math","max","overdrag","min","sortableColumns","flatData","newOrder","sort","a","forEach","i","xIndex","xScale","transition","ease","transitionEase","duration","transitionDuration","p","columnMoved","columnBoundaryClipKey","columnBlock","splitToPanels","dragHandle","barWiggleRoom","headerColumnBlock","headerBlock","cellsColumnBlock","cellsBlock","renderColumnCellTree","scrollAreaClip","scrollAreaClipRect","columnBoundary","columnBoundaryClippath","columnBoundaryRect","roundHalfWidth","updateBlockYPosition","ceil","maxLineWidth","_uid","specIndex","selection","concat","apply","g","__data__","bypassVisibleBar","calcTotalHeight","blocks","rowBlocks","firstRowAnchor","length","rowsHeight","Infinity","scrollbarKit","s","totalHeight","scrollableAreaHeight","groupHeight","headerHeight","currentlyVisibleHeight","ratio","barLength","goldenRatio","scrollbarWidth","wiggleRoom","topY","bottomY","dragMultiplier","xPosition","scrollbarOffset","scrollbar","scrollbarSlider","scrollbarGlyph","delay","scrollbarHideDelay","scrollbarHideDuration","scrollbarCaptureZone","scrollbarCaptureWidth","y","bbox","getBoundingClientRect","pixelVal","top","inverseScale","scale","linear","domain","range","clamp","scrollbarScrollInProgress","allColumnBlock","columnCells","renderColumnCells","columnCell","renderColumnCell","supplyStylingValues","cellRect","renderCellRect","sizeAndStyleRect","cellTextHolder","renderCellTextHolder","cellText","renderCellText","setFont","populateCellText","setCellHeightAndPositionY","splitToCells","keyWithinBlock","spec","cells","font","col","column","gridPick","color","family","rowNumber","align","cellBorderWidth","line","atomicSelection","stroke","fill","text","row","userSuppliedContent","value","stringSupplied","hasBreaks","match","userBrokenText","mayHaveMarkup","latex","isLatex","prefix","suffix","format","prefixSuffixedText","hasWrapSplitCharacter","wrappingNeeded","wrapped","hasWrapCharacter","cellHeightMayIncrease","needsConvertToTspans","textToRender","hrefPreservedText","wrapSplitCharacter","replace","fragments","split","hrefRestoredFragments","frag","f","push","fragment","wrapSpacer","join","lineBreaker","element","renderCallback","wrapTextMaker","updateYPositionMaker","convertToTspans","parentNode","cellPad","left","center","right","content","latexCheck","indexOf","indices","o","gdColumnsOriginalOrder","gdColumns","columnorder","emit","Array","isArray","releaseTransitionEase","releaseTransitionDuration","type","headerBlocks","auxiliaryBlocks","reduce","n","findPagesAndCacheHeights","scrollHeight","pages","pTop","blockIndex","block","blockRows","rows","rowHeight","allRowsHeight","pBottom","windowTop","windowBottom","undefined","bottom","unshift","reverse","page","yTranslate","conditionalPanelRerender","prevPages","allTableControlView","optionalMultiplier","optionalPosition","dragRow","eventD","multiplier","initialScrollY","dy","revolverIndex","shouldComponentUpdate","clearTimeout","currentRepaint","setTimeout","toRerender","wrapText","getComputedTextLength","separatorLength","rest","slice","currentRow","currentAddition","currentAdditionLength","currentRowLength","rowLengthLimit","shift","updateYPosition","settledY","getBlock","rowIndex","firstRowIndex","declaredRowHeight","requiredHeight","finalHeight","increase","columnCellElement","box","rectBox","node","currentTransform","transform","baseVal","consolidate","yPosition","matrix","optionalWidth","rowAnchor","yOffset","getRow","total","rowBlock","cached"],"sources":["/home/yasmin/Área de Trabalho/Frontend/node_modules/plotly.js/src/traces/table/plot.js"],"sourcesContent":["/**\n* Copyright 2012-2019, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n\n'use strict';\n\nvar c = require('./constants');\nvar d3 = require('d3');\nvar gup = require('../../lib/gup');\nvar Drawing = require('../../components/drawing');\nvar svgUtil = require('../../lib/svg_text_utils');\nvar raiseToTop = require('../../lib').raiseToTop;\nvar cancelEeaseColumn = require('../../lib').cancelTransition;\nvar prepareData = require('./data_preparation_helper');\nvar splitData = require('./data_split_helpers');\nvar Color = require('../../components/color');\n\nmodule.exports = function plot(gd, wrappedTraceHolders) {\n    var dynamic = !gd._context.staticPlot;\n\n    var table = gd._fullLayout._paper.selectAll('.' + c.cn.table)\n        .data(wrappedTraceHolders.map(function(wrappedTraceHolder) {\n            var traceHolder = gup.unwrap(wrappedTraceHolder);\n            var trace = traceHolder.trace;\n            return prepareData(gd, trace);\n        }), gup.keyFun);\n\n    table.exit().remove();\n\n    table.enter()\n        .append('g')\n        .classed(c.cn.table, true)\n        .attr('overflow', 'visible')\n        .style('box-sizing', 'content-box')\n        .style('position', 'absolute')\n        .style('left', 0)\n        .style('overflow', 'visible')\n        .style('shape-rendering', 'crispEdges')\n        .style('pointer-events', 'all');\n\n    table\n        .attr('width', function(d) {return d.width + d.size.l + d.size.r;})\n        .attr('height', function(d) {return d.height + d.size.t + d.size.b;})\n        .attr('transform', function(d) {\n            return 'translate(' + d.translateX + ',' + d.translateY + ')';\n        });\n\n    var tableControlView = table.selectAll('.' + c.cn.tableControlView)\n        .data(gup.repeat, gup.keyFun);\n\n    var cvEnter = tableControlView.enter()\n        .append('g')\n        .classed(c.cn.tableControlView, true)\n        .style('box-sizing', 'content-box');\n    if(dynamic) {\n        cvEnter\n            .on('mousemove', function(d) {\n                tableControlView\n                    .filter(function(dd) {return d === dd;})\n                    .call(renderScrollbarKit, gd);\n            })\n            .on('mousewheel', function(d) {\n                if(d.scrollbarState.wheeling) return;\n                d.scrollbarState.wheeling = true;\n                var newY = d.scrollY + d3.event.deltaY;\n                var noChange = makeDragRow(gd, tableControlView, null, newY)(d);\n                if(!noChange) {\n                    d3.event.stopPropagation();\n                    d3.event.preventDefault();\n                }\n                d.scrollbarState.wheeling = false;\n            })\n            .call(renderScrollbarKit, gd, true);\n    }\n\n    tableControlView\n        .attr('transform', function(d) {return 'translate(' + d.size.l + ' ' + d.size.t + ')';});\n\n    // scrollBackground merely ensures that mouse events are captured even on crazy fast scrollwheeling\n    // otherwise rendering glitches may occur\n    var scrollBackground = tableControlView.selectAll('.' + c.cn.scrollBackground)\n        .data(gup.repeat, gup.keyFun);\n\n    scrollBackground.enter()\n        .append('rect')\n        .classed(c.cn.scrollBackground, true)\n        .attr('fill', 'none');\n\n    scrollBackground\n        .attr('width', function(d) {return d.width;})\n        .attr('height', function(d) {return d.height;});\n\n    tableControlView.each(function(d) {\n        Drawing.setClipUrl(d3.select(this), scrollAreaBottomClipKey(gd, d), gd);\n    });\n\n    var yColumn = tableControlView.selectAll('.' + c.cn.yColumn)\n        .data(function(vm) {return vm.columns;}, gup.keyFun);\n\n    yColumn.enter()\n        .append('g')\n        .classed(c.cn.yColumn, true);\n\n    yColumn.exit().remove();\n\n    yColumn.attr('transform', function(d) {return 'translate(' + d.x + ' 0)';});\n\n    if(dynamic) {\n        yColumn.call(d3.behavior.drag()\n            .origin(function(d) {\n                var movedColumn = d3.select(this);\n                easeColumn(movedColumn, d, -c.uplift);\n                raiseToTop(this);\n                d.calcdata.columnDragInProgress = true;\n                renderScrollbarKit(tableControlView.filter(function(dd) {return d.calcdata.key === dd.key;}), gd);\n                return d;\n            })\n            .on('drag', function(d) {\n                var movedColumn = d3.select(this);\n                var getter = function(dd) {return (d === dd ? d3.event.x : dd.x) + dd.columnWidth / 2;};\n                d.x = Math.max(-c.overdrag, Math.min(d.calcdata.width + c.overdrag - d.columnWidth, d3.event.x));\n\n                var sortableColumns = flatData(yColumn).filter(function(dd) {return dd.calcdata.key === d.calcdata.key;});\n                var newOrder = sortableColumns.sort(function(a, b) {return getter(a) - getter(b);});\n                newOrder.forEach(function(dd, i) {\n                    dd.xIndex = i;\n                    dd.x = d === dd ? dd.x : dd.xScale(dd);\n                });\n\n                yColumn.filter(function(dd) {return d !== dd;})\n                    .transition()\n                    .ease(c.transitionEase)\n                    .duration(c.transitionDuration)\n                    .attr('transform', function(d) {return 'translate(' + d.x + ' 0)';});\n                movedColumn\n                    .call(cancelEeaseColumn)\n                    .attr('transform', 'translate(' + d.x + ' -' + c.uplift + ' )');\n            })\n            .on('dragend', function(d) {\n                var movedColumn = d3.select(this);\n                var p = d.calcdata;\n                d.x = d.xScale(d);\n                d.calcdata.columnDragInProgress = false;\n                easeColumn(movedColumn, d, 0);\n                columnMoved(gd, p, p.columns.map(function(dd) {return dd.xIndex;}));\n            })\n        );\n    }\n\n    yColumn.each(function(d) {\n        Drawing.setClipUrl(d3.select(this), columnBoundaryClipKey(gd, d), gd);\n    });\n\n    var columnBlock = yColumn.selectAll('.' + c.cn.columnBlock)\n        .data(splitData.splitToPanels, gup.keyFun);\n\n    columnBlock.enter()\n        .append('g')\n        .classed(c.cn.columnBlock, true)\n        .attr('id', function(d) {return d.key;});\n\n    columnBlock\n        .style('cursor', function(d) {\n            return d.dragHandle ? 'ew-resize' : d.calcdata.scrollbarState.barWiggleRoom ? 'ns-resize' : 'default';\n        });\n\n    var headerColumnBlock = columnBlock.filter(headerBlock);\n    var cellsColumnBlock = columnBlock.filter(cellsBlock);\n\n    if(dynamic) {\n        cellsColumnBlock.call(d3.behavior.drag()\n            .origin(function(d) {\n                d3.event.stopPropagation();\n                return d;\n            })\n            .on('drag', makeDragRow(gd, tableControlView, -1))\n            .on('dragend', function() {\n                // fixme emit plotly notification\n            })\n        );\n    }\n\n    // initial rendering: header is rendered first, as it may may have async LaTeX (show header first)\n    // but blocks are _entered_ the way they are due to painter's algo (header on top)\n    renderColumnCellTree(gd, tableControlView, headerColumnBlock, columnBlock);\n    renderColumnCellTree(gd, tableControlView, cellsColumnBlock, columnBlock);\n\n    var scrollAreaClip = tableControlView.selectAll('.' + c.cn.scrollAreaClip)\n        .data(gup.repeat, gup.keyFun);\n\n    scrollAreaClip.enter()\n        .append('clipPath')\n        .classed(c.cn.scrollAreaClip, true)\n        .attr('id', function(d) {return scrollAreaBottomClipKey(gd, d);});\n\n    var scrollAreaClipRect = scrollAreaClip.selectAll('.' + c.cn.scrollAreaClipRect)\n        .data(gup.repeat, gup.keyFun);\n\n    scrollAreaClipRect.enter()\n        .append('rect')\n        .classed(c.cn.scrollAreaClipRect, true)\n        .attr('x', -c.overdrag)\n        .attr('y', -c.uplift)\n        .attr('fill', 'none');\n\n    scrollAreaClipRect\n        .attr('width', function(d) {return d.width + 2 * c.overdrag;})\n        .attr('height', function(d) {return d.height + c.uplift;});\n\n    var columnBoundary = yColumn.selectAll('.' + c.cn.columnBoundary)\n        .data(gup.repeat, gup.keyFun);\n\n    columnBoundary.enter()\n        .append('g')\n        .classed(c.cn.columnBoundary, true);\n\n    var columnBoundaryClippath = yColumn.selectAll('.' + c.cn.columnBoundaryClippath)\n        .data(gup.repeat, gup.keyFun);\n\n    // SVG spec doesn't mandate wrapping into a <defs> and doesn't seem to cause a speed difference\n    columnBoundaryClippath.enter()\n        .append('clipPath')\n        .classed(c.cn.columnBoundaryClippath, true);\n\n    columnBoundaryClippath\n        .attr('id', function(d) {return columnBoundaryClipKey(gd, d);});\n\n    var columnBoundaryRect = columnBoundaryClippath.selectAll('.' + c.cn.columnBoundaryRect)\n        .data(gup.repeat, gup.keyFun);\n\n    columnBoundaryRect.enter()\n        .append('rect')\n        .classed(c.cn.columnBoundaryRect, true)\n        .attr('fill', 'none');\n\n    columnBoundaryRect\n        .attr('width', function(d) { return d.columnWidth + 2 * roundHalfWidth(d); })\n        .attr('height', function(d) {return d.calcdata.height + 2 * roundHalfWidth(d) + c.uplift;})\n        .attr('x', function(d) { return -roundHalfWidth(d); })\n        .attr('y', function(d) { return -roundHalfWidth(d); });\n\n    updateBlockYPosition(null, cellsColumnBlock, tableControlView);\n};\n\nfunction roundHalfWidth(d) {\n    return Math.ceil(d.calcdata.maxLineWidth / 2);\n}\n\nfunction scrollAreaBottomClipKey(gd, d) {\n    return 'clip' + gd._fullLayout._uid + '_scrollAreaBottomClip_' + d.key;\n}\n\nfunction columnBoundaryClipKey(gd, d) {\n    return 'clip' + gd._fullLayout._uid + '_columnBoundaryClippath_' + d.calcdata.key + '_' + d.specIndex;\n}\n\nfunction flatData(selection) {\n    return [].concat.apply([], selection.map(function(g) {return g;}))\n        .map(function(g) {return g.__data__;});\n}\n\nfunction renderScrollbarKit(tableControlView, gd, bypassVisibleBar) {\n\n    function calcTotalHeight(d) {\n        var blocks = d.rowBlocks;\n        return firstRowAnchor(blocks, blocks.length - 1) + (blocks.length ? rowsHeight(blocks[blocks.length - 1], Infinity) : 1);\n    }\n\n    var scrollbarKit = tableControlView.selectAll('.' + c.cn.scrollbarKit)\n        .data(gup.repeat, gup.keyFun);\n\n    scrollbarKit.enter()\n        .append('g')\n        .classed(c.cn.scrollbarKit, true)\n        .style('shape-rendering', 'geometricPrecision');\n\n    scrollbarKit\n        .each(function(d) {\n            var s = d.scrollbarState;\n            s.totalHeight = calcTotalHeight(d);\n            s.scrollableAreaHeight = d.groupHeight - headerHeight(d);\n            s.currentlyVisibleHeight = Math.min(s.totalHeight, s.scrollableAreaHeight);\n            s.ratio = s.currentlyVisibleHeight / s.totalHeight;\n            s.barLength = Math.max(s.ratio * s.currentlyVisibleHeight, c.goldenRatio * c.scrollbarWidth);\n            s.barWiggleRoom = s.currentlyVisibleHeight - s.barLength;\n            s.wiggleRoom = Math.max(0, s.totalHeight - s.scrollableAreaHeight);\n            s.topY = s.barWiggleRoom === 0 ? 0 : (d.scrollY / s.wiggleRoom) * s.barWiggleRoom;\n            s.bottomY = s.topY + s.barLength;\n            s.dragMultiplier = s.wiggleRoom / s.barWiggleRoom;\n        })\n        .attr('transform', function(d) {\n            var xPosition = d.width + c.scrollbarWidth / 2 + c.scrollbarOffset;\n            return 'translate(' + xPosition + ' ' + headerHeight(d) + ')';\n        });\n\n    var scrollbar = scrollbarKit.selectAll('.' + c.cn.scrollbar)\n        .data(gup.repeat, gup.keyFun);\n\n    scrollbar.enter()\n        .append('g')\n        .classed(c.cn.scrollbar, true);\n\n    var scrollbarSlider = scrollbar.selectAll('.' + c.cn.scrollbarSlider)\n        .data(gup.repeat, gup.keyFun);\n\n    scrollbarSlider.enter()\n        .append('g')\n        .classed(c.cn.scrollbarSlider, true);\n\n    scrollbarSlider\n        .attr('transform', function(d) {\n            return 'translate(0 ' + (d.scrollbarState.topY || 0) + ')';\n        });\n\n    var scrollbarGlyph = scrollbarSlider.selectAll('.' + c.cn.scrollbarGlyph)\n        .data(gup.repeat, gup.keyFun);\n\n    scrollbarGlyph.enter()\n        .append('line')\n        .classed(c.cn.scrollbarGlyph, true)\n        .attr('stroke', 'black')\n        .attr('stroke-width', c.scrollbarWidth)\n        .attr('stroke-linecap', 'round')\n        .attr('y1', c.scrollbarWidth / 2);\n\n    scrollbarGlyph\n        .attr('y2', function(d) {\n            return d.scrollbarState.barLength - c.scrollbarWidth / 2;\n        })\n        .attr('stroke-opacity', function(d) {\n            return d.columnDragInProgress || !d.scrollbarState.barWiggleRoom || bypassVisibleBar ? 0 : 0.4;\n        });\n\n    // cancel transition: possible pending (also, delayed) transition\n    scrollbarGlyph\n        .transition().delay(0).duration(0);\n\n    scrollbarGlyph\n        .transition().delay(c.scrollbarHideDelay).duration(c.scrollbarHideDuration)\n        .attr('stroke-opacity', 0);\n\n    var scrollbarCaptureZone = scrollbar.selectAll('.' + c.cn.scrollbarCaptureZone)\n        .data(gup.repeat, gup.keyFun);\n\n    scrollbarCaptureZone.enter()\n        .append('line')\n        .classed(c.cn.scrollbarCaptureZone, true)\n        .attr('stroke', 'white')\n        .attr('stroke-opacity', 0.01) // some browser might get rid of a 0 opacity element\n        .attr('stroke-width', c.scrollbarCaptureWidth)\n        .attr('stroke-linecap', 'butt')\n        .attr('y1', 0)\n        .on('mousedown', function(d) {\n            var y = d3.event.y;\n            var bbox = this.getBoundingClientRect();\n            var s = d.scrollbarState;\n            var pixelVal = y - bbox.top;\n            var inverseScale = d3.scale.linear().domain([0, s.scrollableAreaHeight]).range([0, s.totalHeight]).clamp(true);\n            if(!(s.topY <= pixelVal && pixelVal <= s.bottomY)) {\n                makeDragRow(gd, tableControlView, null, inverseScale(pixelVal - s.barLength / 2))(d);\n            }\n        })\n        .call(d3.behavior.drag()\n            .origin(function(d) {\n                d3.event.stopPropagation();\n                d.scrollbarState.scrollbarScrollInProgress = true;\n                return d;\n            })\n            .on('drag', makeDragRow(gd, tableControlView))\n            .on('dragend', function() {\n                // fixme emit Plotly event\n            })\n        );\n\n    scrollbarCaptureZone\n        .attr('y2', function(d) {\n            return d.scrollbarState.scrollableAreaHeight;\n        });\n\n    // Remove scroll glyph and capture zone on static plots\n    // as they don't render properly when converted to PDF\n    // in the Chrome PDF viewer\n    // https://github.com/plotly/streambed/issues/11618\n    if(gd._context.staticPlot) {\n        scrollbarGlyph.remove();\n        scrollbarCaptureZone.remove();\n    }\n}\n\nfunction renderColumnCellTree(gd, tableControlView, columnBlock, allColumnBlock) {\n    // fixme this perf hotspot\n    // this is performance critical code as scrolling calls it on every revolver switch\n    // it appears sufficiently fast but there are plenty of low-hanging fruits for performance optimization\n\n    var columnCells = renderColumnCells(columnBlock);\n\n    var columnCell = renderColumnCell(columnCells);\n\n    supplyStylingValues(columnCell);\n\n    var cellRect = renderCellRect(columnCell);\n\n    sizeAndStyleRect(cellRect);\n\n    var cellTextHolder = renderCellTextHolder(columnCell);\n\n    var cellText = renderCellText(cellTextHolder);\n\n    setFont(cellText);\n    populateCellText(cellText, tableControlView, allColumnBlock, gd);\n\n    // doing this at the end when text, and text stlying are set\n    setCellHeightAndPositionY(columnCell);\n}\n\nfunction renderColumnCells(columnBlock) {\n\n    var columnCells = columnBlock.selectAll('.' + c.cn.columnCells)\n        .data(gup.repeat, gup.keyFun);\n\n    columnCells.enter()\n        .append('g')\n        .classed(c.cn.columnCells, true);\n\n    columnCells.exit()\n        .remove();\n\n    return columnCells;\n}\n\nfunction renderColumnCell(columnCells) {\n\n    var columnCell = columnCells.selectAll('.' + c.cn.columnCell)\n        .data(splitData.splitToCells, function(d) {return d.keyWithinBlock;});\n\n    columnCell.enter()\n        .append('g')\n        .classed(c.cn.columnCell, true);\n\n    columnCell.exit()\n        .remove();\n\n    return columnCell;\n}\n\nfunction renderCellRect(columnCell) {\n\n    var cellRect = columnCell.selectAll('.' + c.cn.cellRect)\n        .data(gup.repeat, function(d) {return d.keyWithinBlock;});\n\n    cellRect.enter()\n        .append('rect')\n        .classed(c.cn.cellRect, true);\n\n    return cellRect;\n}\n\nfunction renderCellText(cellTextHolder) {\n\n    var cellText = cellTextHolder.selectAll('.' + c.cn.cellText)\n        .data(gup.repeat, function(d) {return d.keyWithinBlock;});\n\n    cellText.enter()\n        .append('text')\n        .classed(c.cn.cellText, true)\n        .style('cursor', function() {return 'auto';})\n        .on('mousedown', function() {d3.event.stopPropagation();});\n\n    return cellText;\n}\n\nfunction renderCellTextHolder(columnCell) {\n\n    var cellTextHolder = columnCell.selectAll('.' + c.cn.cellTextHolder)\n        .data(gup.repeat, function(d) {return d.keyWithinBlock;});\n\n    cellTextHolder.enter()\n        .append('g')\n        .classed(c.cn.cellTextHolder, true)\n        .style('shape-rendering', 'geometricPrecision');\n\n    return cellTextHolder;\n}\n\nfunction supplyStylingValues(columnCell) {\n    columnCell\n        .each(function(d, i) {\n            var spec = d.calcdata.cells.font;\n            var col = d.column.specIndex;\n            var font = {\n                size: gridPick(spec.size, col, i),\n                color: gridPick(spec.color, col, i),\n                family: gridPick(spec.family, col, i)\n            };\n            d.rowNumber = d.key;\n            d.align = gridPick(d.calcdata.cells.align, col, i);\n            d.cellBorderWidth = gridPick(d.calcdata.cells.line.width, col, i);\n            d.font = font;\n        });\n}\n\nfunction setFont(cellText) {\n    cellText\n        .each(function(d) {\n            Drawing.font(d3.select(this), d.font);\n        });\n}\n\nfunction sizeAndStyleRect(cellRect) {\n    cellRect\n        .attr('width', function(d) {return d.column.columnWidth;})\n        .attr('stroke-width', function(d) {return d.cellBorderWidth;})\n        .each(function(d) {\n            var atomicSelection = d3.select(this);\n            Color.stroke(atomicSelection, gridPick(d.calcdata.cells.line.color, d.column.specIndex, d.rowNumber));\n            Color.fill(atomicSelection, gridPick(d.calcdata.cells.fill.color, d.column.specIndex, d.rowNumber));\n        });\n}\n\nfunction populateCellText(cellText, tableControlView, allColumnBlock, gd) {\n    cellText\n        .text(function(d) {\n\n            var col = d.column.specIndex;\n            var row = d.rowNumber;\n\n            var userSuppliedContent = d.value;\n            var stringSupplied = (typeof userSuppliedContent === 'string');\n            var hasBreaks = stringSupplied && userSuppliedContent.match(/<br>/i);\n            var userBrokenText = !stringSupplied || hasBreaks;\n            d.mayHaveMarkup = stringSupplied && userSuppliedContent.match(/[<&>]/);\n\n            var latex = isLatex(userSuppliedContent);\n            d.latex = latex;\n\n            var prefix = latex ? '' : gridPick(d.calcdata.cells.prefix, col, row) || '';\n            var suffix = latex ? '' : gridPick(d.calcdata.cells.suffix, col, row) || '';\n            var format = latex ? null : gridPick(d.calcdata.cells.format, col, row) || null;\n\n            var prefixSuffixedText = prefix + (format ? d3.format(format)(d.value) : d.value) + suffix;\n\n            var hasWrapSplitCharacter;\n            d.wrappingNeeded = !d.wrapped && !userBrokenText && !latex && (hasWrapSplitCharacter = hasWrapCharacter(prefixSuffixedText));\n            d.cellHeightMayIncrease = hasBreaks || latex || d.mayHaveMarkup || (hasWrapSplitCharacter === void(0) ? hasWrapCharacter(prefixSuffixedText) : hasWrapSplitCharacter);\n            d.needsConvertToTspans = d.mayHaveMarkup || d.wrappingNeeded || d.latex;\n\n            var textToRender;\n            if(d.wrappingNeeded) {\n                var hrefPreservedText = c.wrapSplitCharacter === ' ' ? prefixSuffixedText.replace(/<a href=/ig, '<a_href=') : prefixSuffixedText;\n                var fragments = hrefPreservedText.split(c.wrapSplitCharacter);\n                var hrefRestoredFragments = c.wrapSplitCharacter === ' ' ? fragments.map(function(frag) {return frag.replace(/<a_href=/ig, '<a href=');}) : fragments;\n                d.fragments = hrefRestoredFragments.map(function(f) {return {text: f, width: null};});\n                d.fragments.push({fragment: c.wrapSpacer, width: null});\n                textToRender = hrefRestoredFragments.join(c.lineBreaker) + c.lineBreaker + c.wrapSpacer;\n            } else {\n                delete d.fragments;\n                textToRender = prefixSuffixedText;\n            }\n\n            return textToRender;\n        })\n        .attr('dy', function(d) {\n            return d.needsConvertToTspans ? 0 : '0.75em';\n        })\n        .each(function(d) {\n\n            var element = this;\n            var selection = d3.select(element);\n\n            // finalize what's in the DOM\n\n            var renderCallback = d.wrappingNeeded ? wrapTextMaker : updateYPositionMaker;\n            if(d.needsConvertToTspans) {\n                svgUtil.convertToTspans(selection, gd, renderCallback(allColumnBlock, element, tableControlView, gd, d));\n            } else {\n                d3.select(element.parentNode)\n                    // basic cell adjustment - compliance with `cellPad`\n                    .attr('transform', function(d) {return 'translate(' + xPosition(d) + ' ' + c.cellPad + ')';})\n                    .attr('text-anchor', function(d) {\n                        return ({\n                            left: 'start',\n                            center: 'middle',\n                            right: 'end'\n                        })[d.align];\n                    });\n            }\n        });\n}\n\nfunction isLatex(content) {\n    return typeof content === 'string' && content.match(c.latexCheck);\n}\n\nfunction hasWrapCharacter(text) {return text.indexOf(c.wrapSplitCharacter) !== -1;}\n\nfunction columnMoved(gd, calcdata, indices) {\n    var o = calcdata.gdColumnsOriginalOrder;\n    calcdata.gdColumns.sort(function(a, b) {\n        return indices[o.indexOf(a)] - indices[o.indexOf(b)];\n    });\n\n    calcdata.columnorder = indices;\n\n    // TODO: there's no data here, but also this reordering is not reflected\n    // in gd.data or even gd._fullData.\n    // For now I will not attempt to persist this in _preGUI\n    gd.emit('plotly_restyle');\n}\n\nfunction gridPick(spec, col, row) {\n    if(Array.isArray(spec)) {\n        var column = spec[Math.min(col, spec.length - 1)];\n        if(Array.isArray(column)) {\n            return column[Math.min(row, column.length - 1)];\n        } else {\n            return column;\n        }\n    } else {\n        return spec;\n    }\n}\n\nfunction easeColumn(selection, d, y) {\n    selection\n        .transition()\n        .ease(c.releaseTransitionEase)\n        .duration(c.releaseTransitionDuration)\n        .attr('transform', 'translate(' + d.x + ' ' + y + ')');\n}\n\nfunction cellsBlock(d) {return d.type === 'cells';}\nfunction headerBlock(d) {return d.type === 'header';}\n\n/**\n * Revolver panel and cell contents layouting\n */\n\nfunction headerHeight(d) {\n    var headerBlocks = d.rowBlocks.length ? d.rowBlocks[0].auxiliaryBlocks : [];\n    return headerBlocks.reduce(function(p, n) {return p + rowsHeight(n, Infinity);}, 0);\n}\n\nfunction findPagesAndCacheHeights(blocks, scrollY, scrollHeight) {\n\n    var pages = [];\n    var pTop = 0;\n\n    for(var blockIndex = 0; blockIndex < blocks.length; blockIndex++) {\n\n        var block = blocks[blockIndex];\n        var blockRows = block.rows;\n        var rowsHeight = 0;\n        for(var i = 0; i < blockRows.length; i++) {\n            rowsHeight += blockRows[i].rowHeight;\n        }\n\n        // caching allRowsHeight on the block - it's safe as this function is always called from within the code part\n        // that handles increases to row heights\n        block.allRowsHeight = rowsHeight;\n\n        var pBottom = pTop + rowsHeight;\n        var windowTop = scrollY;\n        var windowBottom = windowTop + scrollHeight;\n        if(windowTop < pBottom && windowBottom > pTop) {\n            pages.push(blockIndex);\n        }\n        pTop += rowsHeight;\n\n        // consider this nice final optimization; put it in `for` condition - caveat, currently the\n        // block.allRowsHeight relies on being invalidated, so enabling this opt may not be safe\n        // if(pages.length > 1) break;\n    }\n\n    return pages;\n}\n\nfunction updateBlockYPosition(gd, cellsColumnBlock, tableControlView) {\n    var d = flatData(cellsColumnBlock)[0];\n    if(d === undefined) return;\n    var blocks = d.rowBlocks;\n    var calcdata = d.calcdata;\n\n    var bottom = firstRowAnchor(blocks, blocks.length);\n    var scrollHeight = d.calcdata.groupHeight - headerHeight(d);\n    var scrollY = calcdata.scrollY = Math.max(0, Math.min(bottom - scrollHeight, calcdata.scrollY));\n\n    var pages = findPagesAndCacheHeights(blocks, scrollY, scrollHeight);\n    if(pages.length === 1) {\n        if(pages[0] === blocks.length - 1) {\n            pages.unshift(pages[0] - 1);\n        } else {\n            pages.push(pages[0] + 1);\n        }\n    }\n\n    // make phased out page jump by 2 while leaving stationary page intact\n    if(pages[0] % 2) {\n        pages.reverse();\n    }\n\n    cellsColumnBlock\n        .each(function(d, i) {\n            // these values will also be needed when a block is translated again due to growing cell height\n            d.page = pages[i];\n            d.scrollY = scrollY;\n        });\n\n    cellsColumnBlock\n        .attr('transform', function(d) {\n            var yTranslate = firstRowAnchor(d.rowBlocks, d.page) - d.scrollY;\n            return 'translate(0 ' + yTranslate + ')';\n        });\n\n    // conditionally rerendering panel 0 and 1\n    if(gd) {\n        conditionalPanelRerender(gd, tableControlView, cellsColumnBlock, pages, d.prevPages, d, 0);\n        conditionalPanelRerender(gd, tableControlView, cellsColumnBlock, pages, d.prevPages, d, 1);\n        renderScrollbarKit(tableControlView, gd);\n    }\n}\n\nfunction makeDragRow(gd, allTableControlView, optionalMultiplier, optionalPosition) {\n    return function dragRow(eventD) {\n        // may come from whichever DOM event target: drag, wheel, bar... eventD corresponds to event target\n        var d = eventD.calcdata ? eventD.calcdata : eventD;\n        var tableControlView = allTableControlView.filter(function(dd) {return d.key === dd.key;});\n        var multiplier = optionalMultiplier || d.scrollbarState.dragMultiplier;\n\n        var initialScrollY = d.scrollY;\n\n        d.scrollY = optionalPosition === void(0) ? d.scrollY + multiplier * d3.event.dy : optionalPosition;\n        var cellsColumnBlock = tableControlView.selectAll('.' + c.cn.yColumn).selectAll('.' + c.cn.columnBlock).filter(cellsBlock);\n        updateBlockYPosition(gd, cellsColumnBlock, tableControlView);\n\n        // return false if we've \"used\" the scroll, ie it did something,\n        // so the event shouldn't bubble (if appropriate)\n        return d.scrollY === initialScrollY;\n    };\n}\n\nfunction conditionalPanelRerender(gd, tableControlView, cellsColumnBlock, pages, prevPages, d, revolverIndex) {\n    var shouldComponentUpdate = pages[revolverIndex] !== prevPages[revolverIndex];\n    if(shouldComponentUpdate) {\n        clearTimeout(d.currentRepaint[revolverIndex]);\n        d.currentRepaint[revolverIndex] = setTimeout(function() {\n            // setTimeout might lag rendering but yields a smoother scroll, because fast scrolling makes\n            // some repaints invisible ie. wasteful (DOM work blocks the main thread)\n            var toRerender = cellsColumnBlock.filter(function(d, i) {return i === revolverIndex && pages[i] !== prevPages[i];});\n            renderColumnCellTree(gd, tableControlView, toRerender, cellsColumnBlock);\n            prevPages[revolverIndex] = pages[revolverIndex];\n        });\n    }\n}\n\nfunction wrapTextMaker(columnBlock, element, tableControlView, gd) {\n    return function wrapText() {\n        var cellTextHolder = d3.select(element.parentNode);\n        cellTextHolder\n            .each(function(d) {\n                var fragments = d.fragments;\n                cellTextHolder.selectAll('tspan.line').each(function(dd, i) {\n                    fragments[i].width = this.getComputedTextLength();\n                });\n                // last element is only for measuring the separator character, so it's ignored:\n                var separatorLength = fragments[fragments.length - 1].width;\n                var rest = fragments.slice(0, -1);\n                var currentRow = [];\n                var currentAddition, currentAdditionLength;\n                var currentRowLength = 0;\n                var rowLengthLimit = d.column.columnWidth - 2 * c.cellPad;\n                d.value = '';\n                while(rest.length) {\n                    currentAddition = rest.shift();\n                    currentAdditionLength = currentAddition.width + separatorLength;\n                    if(currentRowLength + currentAdditionLength > rowLengthLimit) {\n                        d.value += currentRow.join(c.wrapSpacer) + c.lineBreaker;\n                        currentRow = [];\n                        currentRowLength = 0;\n                    }\n                    currentRow.push(currentAddition.text);\n                    currentRowLength += currentAdditionLength;\n                }\n                if(currentRowLength) {\n                    d.value += currentRow.join(c.wrapSpacer);\n                }\n                d.wrapped = true;\n            });\n\n        // the pre-wrapped text was rendered only for the text measurements\n        cellTextHolder.selectAll('tspan.line').remove();\n\n        // resupply text, now wrapped\n        populateCellText(cellTextHolder.select('.' + c.cn.cellText), tableControlView, columnBlock, gd);\n        d3.select(element.parentNode.parentNode).call(setCellHeightAndPositionY);\n    };\n}\n\nfunction updateYPositionMaker(columnBlock, element, tableControlView, gd, d) {\n    return function updateYPosition() {\n        if(d.settledY) return;\n        var cellTextHolder = d3.select(element.parentNode);\n        var l = getBlock(d);\n        var rowIndex = d.key - l.firstRowIndex;\n\n        var declaredRowHeight = l.rows[rowIndex].rowHeight;\n\n        var requiredHeight = d.cellHeightMayIncrease ? element.parentNode.getBoundingClientRect().height + 2 * c.cellPad : declaredRowHeight;\n\n        var finalHeight = Math.max(requiredHeight, declaredRowHeight);\n        var increase = finalHeight - l.rows[rowIndex].rowHeight;\n\n        if(increase) {\n\n            // current row height increased\n            l.rows[rowIndex].rowHeight = finalHeight;\n\n            columnBlock\n                .selectAll('.' + c.cn.columnCell)\n                .call(setCellHeightAndPositionY);\n\n            updateBlockYPosition(null, columnBlock.filter(cellsBlock), 0);\n\n            // if d.column.type === 'header', then the scrollbar has to be pushed downward to the scrollable area\n            // if d.column.type === 'cells', it can still be relevant if total scrolling content height is less than the\n            //                               scrollable window, as increases to row heights may need scrollbar updates\n            renderScrollbarKit(tableControlView, gd, true);\n        }\n\n        cellTextHolder\n            .attr('transform', function() {\n                // this code block is only invoked for items where d.cellHeightMayIncrease is truthy\n                var element = this;\n                var columnCellElement = element.parentNode;\n                var box = columnCellElement.getBoundingClientRect();\n                var rectBox = d3.select(element.parentNode).select('.' + c.cn.cellRect).node().getBoundingClientRect();\n                var currentTransform = element.transform.baseVal.consolidate();\n                var yPosition = rectBox.top - box.top + (currentTransform ? currentTransform.matrix.f : c.cellPad);\n                return 'translate(' + xPosition(d, d3.select(element.parentNode).select('.' + c.cn.cellTextHolder).node().getBoundingClientRect().width) + ' ' + yPosition + ')';\n            });\n\n        d.settledY = true;\n    };\n}\n\nfunction xPosition(d, optionalWidth) {\n    switch(d.align) {\n        case 'left': return c.cellPad;\n        case 'right': return d.column.columnWidth - (optionalWidth || 0) - c.cellPad;\n        case 'center': return (d.column.columnWidth - (optionalWidth || 0)) / 2;\n        default: return c.cellPad;\n    }\n}\n\nfunction setCellHeightAndPositionY(columnCell) {\n    columnCell\n        .attr('transform', function(d) {\n            var headerHeight = d.rowBlocks[0].auxiliaryBlocks.reduce(function(p, n) {return p + rowsHeight(n, Infinity);}, 0);\n            var l = getBlock(d);\n            var rowAnchor = rowsHeight(l, d.key);\n            var yOffset = rowAnchor + headerHeight;\n            return 'translate(0 ' + yOffset + ')';\n        })\n        .selectAll('.' + c.cn.cellRect)\n        .attr('height', function(d) {return getRow(getBlock(d), d.key).rowHeight;});\n}\n\nfunction firstRowAnchor(blocks, page) {\n    var total = 0;\n    for(var i = page - 1; i >= 0; i--) {\n        total += allRowsHeight(blocks[i]);\n    }\n    return total;\n}\n\nfunction rowsHeight(rowBlock, key) {\n    var total = 0;\n    for(var i = 0; i < rowBlock.rows.length && rowBlock.rows[i].rowIndex < key; i++) {\n        total += rowBlock.rows[i].rowHeight;\n    }\n    return total;\n}\n\nfunction allRowsHeight(rowBlock) {\n    var cached = rowBlock.allRowsHeight;\n\n    if(cached !== void(0)) {\n        return cached;\n    }\n\n    var total = 0;\n    for(var i = 0; i < rowBlock.rows.length; i++) {\n        total += rowBlock.rows[i].rowHeight;\n    }\n    rowBlock.allRowsHeight = total;\n\n    return total;\n}\n\nfunction getBlock(d) {return d.rowBlocks[d.page];}\nfunction getRow(l, i) {return l.rows[i - l.firstRowIndex];}\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}