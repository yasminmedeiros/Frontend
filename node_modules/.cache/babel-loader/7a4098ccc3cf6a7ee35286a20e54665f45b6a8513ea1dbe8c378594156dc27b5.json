{"ast":null,"code":"'use strict';\n\nexports.shader = getShaderReference;\nexports.program = createProgram;\nvar GLError = require(\"./GLError\");\nvar formatCompilerError = require('gl-format-compiler-error');\nvar weakMap = typeof WeakMap === 'undefined' ? require('weakmap-shim') : WeakMap;\nvar CACHE = new weakMap();\nvar SHADER_COUNTER = 0;\nfunction ShaderReference(id, src, type, shader, programs, count, cache) {\n  this.id = id;\n  this.src = src;\n  this.type = type;\n  this.shader = shader;\n  this.count = count;\n  this.programs = [];\n  this.cache = cache;\n}\nShaderReference.prototype.dispose = function () {\n  if (--this.count === 0) {\n    var cache = this.cache;\n    var gl = cache.gl;\n\n    //Remove program references\n    var programs = this.programs;\n    for (var i = 0, n = programs.length; i < n; ++i) {\n      var p = cache.programs[programs[i]];\n      if (p) {\n        delete cache.programs[i];\n        gl.deleteProgram(p);\n      }\n    }\n\n    //Remove shader reference\n    gl.deleteShader(this.shader);\n    delete cache.shaders[this.type === gl.FRAGMENT_SHADER | 0][this.src];\n  }\n};\nfunction ContextCache(gl) {\n  this.gl = gl;\n  this.shaders = [{}, {}];\n  this.programs = {};\n}\nvar proto = ContextCache.prototype;\nfunction compileShader(gl, type, src) {\n  var shader = gl.createShader(type);\n  gl.shaderSource(shader, src);\n  gl.compileShader(shader);\n  if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n    var errLog = gl.getShaderInfoLog(shader);\n    try {\n      var fmt = formatCompilerError(errLog, src, type);\n    } catch (e) {\n      console.warn('Failed to format compiler error: ' + e);\n      throw new GLError(errLog, 'Error compiling shader:\\n' + errLog);\n    }\n    throw new GLError(errLog, fmt.short, fmt.long);\n  }\n  return shader;\n}\nproto.getShaderReference = function (type, src) {\n  var gl = this.gl;\n  var shaders = this.shaders[type === gl.FRAGMENT_SHADER | 0];\n  var shader = shaders[src];\n  if (!shader || !gl.isShader(shader.shader)) {\n    var shaderObj = compileShader(gl, type, src);\n    shader = shaders[src] = new ShaderReference(SHADER_COUNTER++, src, type, shaderObj, [], 1, this);\n  } else {\n    shader.count += 1;\n  }\n  return shader;\n};\nfunction linkProgram(gl, vshader, fshader, attribs, locations) {\n  var program = gl.createProgram();\n  gl.attachShader(program, vshader);\n  gl.attachShader(program, fshader);\n  for (var i = 0; i < attribs.length; ++i) {\n    gl.bindAttribLocation(program, locations[i], attribs[i]);\n  }\n  gl.linkProgram(program);\n  if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\n    var errLog = gl.getProgramInfoLog(program);\n    throw new GLError(errLog, 'Error linking program: ' + errLog);\n  }\n  return program;\n}\nproto.getProgram = function (vref, fref, attribs, locations) {\n  var token = [vref.id, fref.id, attribs.join(':'), locations.join(':')].join('@');\n  var prog = this.programs[token];\n  if (!prog || !this.gl.isProgram(prog)) {\n    this.programs[token] = prog = linkProgram(this.gl, vref.shader, fref.shader, attribs, locations);\n    vref.programs.push(token);\n    fref.programs.push(token);\n  }\n  return prog;\n};\nfunction getCache(gl) {\n  var ctxCache = CACHE.get(gl);\n  if (!ctxCache) {\n    ctxCache = new ContextCache(gl);\n    CACHE.set(gl, ctxCache);\n  }\n  return ctxCache;\n}\nfunction getShaderReference(gl, type, src) {\n  return getCache(gl).getShaderReference(type, src);\n}\nfunction createProgram(gl, vref, fref, attribs, locations) {\n  return getCache(gl).getProgram(vref, fref, attribs, locations);\n}","map":{"version":3,"names":["exports","shader","getShaderReference","program","createProgram","GLError","require","formatCompilerError","weakMap","WeakMap","CACHE","SHADER_COUNTER","ShaderReference","id","src","type","programs","count","cache","prototype","dispose","gl","i","n","length","p","deleteProgram","deleteShader","shaders","FRAGMENT_SHADER","ContextCache","proto","compileShader","createShader","shaderSource","getShaderParameter","COMPILE_STATUS","errLog","getShaderInfoLog","fmt","e","console","warn","short","long","isShader","shaderObj","linkProgram","vshader","fshader","attribs","locations","attachShader","bindAttribLocation","getProgramParameter","LINK_STATUS","getProgramInfoLog","getProgram","vref","fref","token","join","prog","isProgram","push","getCache","ctxCache","get","set"],"sources":["/home/yasmin/Ãrea de Trabalho/Frontend/node_modules/gl-shader/lib/shader-cache.js"],"sourcesContent":["'use strict'\n\nexports.shader   = getShaderReference\nexports.program  = createProgram\n\nvar GLError = require(\"./GLError\")\nvar formatCompilerError = require('gl-format-compiler-error');\n\nvar weakMap = typeof WeakMap === 'undefined' ? require('weakmap-shim') : WeakMap\nvar CACHE = new weakMap()\n\nvar SHADER_COUNTER = 0\n\nfunction ShaderReference(id, src, type, shader, programs, count, cache) {\n  this.id       = id\n  this.src      = src\n  this.type     = type\n  this.shader   = shader\n  this.count    = count\n  this.programs = []\n  this.cache    = cache\n}\n\nShaderReference.prototype.dispose = function() {\n  if(--this.count === 0) {\n    var cache    = this.cache\n    var gl       = cache.gl\n\n    //Remove program references\n    var programs = this.programs\n    for(var i=0, n=programs.length; i<n; ++i) {\n      var p = cache.programs[programs[i]]\n      if(p) {\n        delete cache.programs[i]\n        gl.deleteProgram(p)\n      }\n    }\n\n    //Remove shader reference\n    gl.deleteShader(this.shader)\n    delete cache.shaders[(this.type === gl.FRAGMENT_SHADER)|0][this.src]\n  }\n}\n\nfunction ContextCache(gl) {\n  this.gl       = gl\n  this.shaders  = [{}, {}]\n  this.programs = {}\n}\n\nvar proto = ContextCache.prototype\n\nfunction compileShader(gl, type, src) {\n  var shader = gl.createShader(type)\n  gl.shaderSource(shader, src)\n  gl.compileShader(shader)\n  if(!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n    var errLog = gl.getShaderInfoLog(shader)\n    try {\n        var fmt = formatCompilerError(errLog, src, type);\n    } catch (e){\n        console.warn('Failed to format compiler error: ' + e);\n        throw new GLError(errLog, 'Error compiling shader:\\n' + errLog)\n    }\n    throw new GLError(errLog, fmt.short, fmt.long)\n  }\n  return shader\n}\n\nproto.getShaderReference = function(type, src) {\n  var gl      = this.gl\n  var shaders = this.shaders[(type === gl.FRAGMENT_SHADER)|0]\n  var shader  = shaders[src]\n  if(!shader || !gl.isShader(shader.shader)) {\n    var shaderObj = compileShader(gl, type, src)\n    shader = shaders[src] = new ShaderReference(\n      SHADER_COUNTER++,\n      src,\n      type,\n      shaderObj,\n      [],\n      1,\n      this)\n  } else {\n    shader.count += 1\n  }\n  return shader\n}\n\nfunction linkProgram(gl, vshader, fshader, attribs, locations) {\n  var program = gl.createProgram()\n  gl.attachShader(program, vshader)\n  gl.attachShader(program, fshader)\n  for(var i=0; i<attribs.length; ++i) {\n    gl.bindAttribLocation(program, locations[i], attribs[i])\n  }\n  gl.linkProgram(program)\n  if(!gl.getProgramParameter(program, gl.LINK_STATUS)) {\n    var errLog = gl.getProgramInfoLog(program)\n    throw new GLError(errLog, 'Error linking program: ' + errLog)\n  }\n  return program\n}\n\nproto.getProgram = function(vref, fref, attribs, locations) {\n  var token = [vref.id, fref.id, attribs.join(':'), locations.join(':')].join('@')\n  var prog  = this.programs[token]\n  if(!prog || !this.gl.isProgram(prog)) {\n    this.programs[token] = prog = linkProgram(\n      this.gl,\n      vref.shader,\n      fref.shader,\n      attribs,\n      locations)\n    vref.programs.push(token)\n    fref.programs.push(token)\n  }\n  return prog\n}\n\nfunction getCache(gl) {\n  var ctxCache = CACHE.get(gl)\n  if(!ctxCache) {\n    ctxCache = new ContextCache(gl)\n    CACHE.set(gl, ctxCache)\n  }\n  return ctxCache\n}\n\nfunction getShaderReference(gl, type, src) {\n  return getCache(gl).getShaderReference(type, src)\n}\n\nfunction createProgram(gl, vref, fref, attribs, locations) {\n  return getCache(gl).getProgram(vref, fref, attribs, locations)\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}