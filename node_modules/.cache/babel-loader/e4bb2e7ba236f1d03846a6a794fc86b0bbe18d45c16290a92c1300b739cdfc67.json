{"ast":null,"code":"'use strict';\n\nmodule.exports = gradient;\nvar dup = require('dup');\nvar cwiseCompiler = require('cwise-compiler');\nvar TEMPLATE_CACHE = {};\nvar GRADIENT_CACHE = {};\nvar EmptyProc = {\n  body: \"\",\n  args: [],\n  thisVars: [],\n  localVars: []\n};\nvar centralDiff = cwiseCompiler({\n  args: ['array', 'array', 'array'],\n  pre: EmptyProc,\n  post: EmptyProc,\n  body: {\n    args: [{\n      name: 'out',\n      lvalue: true,\n      rvalue: false,\n      count: 1\n    }, {\n      name: 'left',\n      lvalue: false,\n      rvalue: true,\n      count: 1\n    }, {\n      name: 'right',\n      lvalue: false,\n      rvalue: true,\n      count: 1\n    }],\n    body: \"out=0.5*(left-right)\",\n    thisVars: [],\n    localVars: []\n  },\n  funcName: 'cdiff'\n});\nvar zeroOut = cwiseCompiler({\n  args: ['array'],\n  pre: EmptyProc,\n  post: EmptyProc,\n  body: {\n    args: [{\n      name: 'out',\n      lvalue: true,\n      rvalue: false,\n      count: 1\n    }],\n    body: \"out=0\",\n    thisVars: [],\n    localVars: []\n  },\n  funcName: 'zero'\n});\nfunction generateTemplate(d) {\n  if (d in TEMPLATE_CACHE) {\n    return TEMPLATE_CACHE[d];\n  }\n  var code = [];\n  for (var i = 0; i < d; ++i) {\n    code.push('out', i, 's=0.5*(inp', i, 'l-inp', i, 'r);');\n  }\n  var args = ['array'];\n  var names = ['junk'];\n  for (var i = 0; i < d; ++i) {\n    args.push('array');\n    names.push('out' + i + 's');\n    var o = dup(d);\n    o[i] = -1;\n    args.push({\n      array: 0,\n      offset: o.slice()\n    });\n    o[i] = 1;\n    args.push({\n      array: 0,\n      offset: o.slice()\n    });\n    names.push('inp' + i + 'l', 'inp' + i + 'r');\n  }\n  return TEMPLATE_CACHE[d] = cwiseCompiler({\n    args: args,\n    pre: EmptyProc,\n    post: EmptyProc,\n    body: {\n      body: code.join(''),\n      args: names.map(function (n) {\n        return {\n          name: n,\n          lvalue: n.indexOf('out') === 0,\n          rvalue: n.indexOf('inp') === 0,\n          count: n !== 'junk' | 0\n        };\n      }),\n      thisVars: [],\n      localVars: []\n    },\n    funcName: 'fdTemplate' + d\n  });\n}\nfunction generateGradient(boundaryConditions) {\n  var token = boundaryConditions.join();\n  var proc = GRADIENT_CACHE[token];\n  if (proc) {\n    return proc;\n  }\n  var d = boundaryConditions.length;\n  var code = ['function gradient(dst,src){var s=src.shape.slice();'];\n  function handleBoundary(facet) {\n    var cod = d - facet.length;\n    var loStr = [];\n    var hiStr = [];\n    var pickStr = [];\n    for (var i = 0; i < d; ++i) {\n      if (facet.indexOf(i + 1) >= 0) {\n        pickStr.push('0');\n      } else if (facet.indexOf(-(i + 1)) >= 0) {\n        pickStr.push('s[' + i + ']-1');\n      } else {\n        pickStr.push('-1');\n        loStr.push('1');\n        hiStr.push('s[' + i + ']-2');\n      }\n    }\n    var boundStr = '.lo(' + loStr.join() + ').hi(' + hiStr.join() + ')';\n    if (loStr.length === 0) {\n      boundStr = '';\n    }\n    if (cod > 0) {\n      code.push('if(1');\n      for (var i = 0; i < d; ++i) {\n        if (facet.indexOf(i + 1) >= 0 || facet.indexOf(-(i + 1)) >= 0) {\n          continue;\n        }\n        code.push('&&s[', i, ']>2');\n      }\n      code.push('){grad', cod, '(src.pick(', pickStr.join(), ')', boundStr);\n      for (var i = 0; i < d; ++i) {\n        if (facet.indexOf(i + 1) >= 0 || facet.indexOf(-(i + 1)) >= 0) {\n          continue;\n        }\n        code.push(',dst.pick(', pickStr.join(), ',', i, ')', boundStr);\n      }\n      code.push(');');\n    }\n    for (var i = 0; i < facet.length; ++i) {\n      var bnd = Math.abs(facet[i]) - 1;\n      var outStr = 'dst.pick(' + pickStr.join() + ',' + bnd + ')' + boundStr;\n      switch (boundaryConditions[bnd]) {\n        case 'clamp':\n          var cPickStr = pickStr.slice();\n          var dPickStr = pickStr.slice();\n          if (facet[i] < 0) {\n            cPickStr[bnd] = 's[' + bnd + ']-2';\n          } else {\n            dPickStr[bnd] = '1';\n          }\n          if (cod === 0) {\n            code.push('if(s[', bnd, ']>1){dst.set(', pickStr.join(), ',', bnd, ',0.5*(src.get(', cPickStr.join(), ')-src.get(', dPickStr.join(), ')))}else{dst.set(', pickStr.join(), ',', bnd, ',0)};');\n          } else {\n            code.push('if(s[', bnd, ']>1){diff(', outStr, ',src.pick(', cPickStr.join(), ')', boundStr, ',src.pick(', dPickStr.join(), ')', boundStr, ');}else{zero(', outStr, ');};');\n          }\n          break;\n        case 'mirror':\n          if (cod === 0) {\n            code.push('dst.set(', pickStr.join(), ',', bnd, ',0);');\n          } else {\n            code.push('zero(', outStr, ');');\n          }\n          break;\n        case 'wrap':\n          var aPickStr = pickStr.slice();\n          var bPickStr = pickStr.slice();\n          if (facet[i] < 0) {\n            aPickStr[bnd] = 's[' + bnd + ']-2';\n            bPickStr[bnd] = '0';\n          } else {\n            aPickStr[bnd] = 's[' + bnd + ']-1';\n            bPickStr[bnd] = '1';\n          }\n          if (cod === 0) {\n            code.push('if(s[', bnd, ']>2){dst.set(', pickStr.join(), ',', bnd, ',0.5*(src.get(', aPickStr.join(), ')-src.get(', bPickStr.join(), ')))}else{dst.set(', pickStr.join(), ',', bnd, ',0)};');\n          } else {\n            code.push('if(s[', bnd, ']>2){diff(', outStr, ',src.pick(', aPickStr.join(), ')', boundStr, ',src.pick(', bPickStr.join(), ')', boundStr, ');}else{zero(', outStr, ');};');\n          }\n          break;\n        default:\n          throw new Error('ndarray-gradient: Invalid boundary condition');\n      }\n    }\n    if (cod > 0) {\n      code.push('};');\n    }\n  }\n\n  //Enumerate ridges, facets, etc. of hypercube\n  for (var i = 0; i < 1 << d; ++i) {\n    var faces = [];\n    for (var j = 0; j < d; ++j) {\n      if (i & 1 << j) {\n        faces.push(j + 1);\n      }\n    }\n    for (var k = 0; k < 1 << faces.length; ++k) {\n      var sfaces = faces.slice();\n      for (var j = 0; j < faces.length; ++j) {\n        if (k & 1 << j) {\n          sfaces[j] = -sfaces[j];\n        }\n      }\n      handleBoundary(sfaces);\n    }\n  }\n  code.push('return dst;};return gradient');\n\n  //Compile and link routine, save cached procedure\n  var linkNames = ['diff', 'zero'];\n  var linkArgs = [centralDiff, zeroOut];\n  for (var i = 1; i <= d; ++i) {\n    linkNames.push('grad' + i);\n    linkArgs.push(generateTemplate(i));\n  }\n  linkNames.push(code.join(''));\n  var link = Function.apply(void 0, linkNames);\n  var proc = link.apply(void 0, linkArgs);\n  TEMPLATE_CACHE[token] = proc;\n  return proc;\n}\nfunction gradient(out, inp, bc) {\n  if (Array.isArray(bc)) {\n    if (bc.length !== inp.dimension) {\n      throw new Error('ndarray-gradient: invalid boundary conditions');\n    }\n  } else if (typeof bc === 'string') {\n    bc = dup(inp.dimension, bc);\n  } else {\n    bc = dup(inp.dimension, 'clamp');\n  }\n  if (out.dimension !== inp.dimension + 1) {\n    throw new Error('ndarray-gradient: output dimension must be +1 input dimension');\n  }\n  if (out.shape[inp.dimension] !== inp.dimension) {\n    throw new Error('ndarray-gradient: output shape must match input shape');\n  }\n  for (var i = 0; i < inp.dimension; ++i) {\n    if (out.shape[i] !== inp.shape[i]) {\n      throw new Error('ndarray-gradient: shape mismatch');\n    }\n  }\n  if (inp.size === 0) {\n    return out;\n  }\n  if (inp.dimension <= 0) {\n    out.set(0);\n    return out;\n  }\n  var cached = generateGradient(bc);\n  return cached(out, inp);\n}","map":{"version":3,"names":["module","exports","gradient","dup","require","cwiseCompiler","TEMPLATE_CACHE","GRADIENT_CACHE","EmptyProc","body","args","thisVars","localVars","centralDiff","pre","post","name","lvalue","rvalue","count","funcName","zeroOut","generateTemplate","d","code","i","push","names","o","array","offset","slice","join","map","n","indexOf","generateGradient","boundaryConditions","token","proc","length","handleBoundary","facet","cod","loStr","hiStr","pickStr","boundStr","bnd","Math","abs","outStr","cPickStr","dPickStr","aPickStr","bPickStr","Error","faces","j","k","sfaces","linkNames","linkArgs","link","Function","apply","out","inp","bc","Array","isArray","dimension","shape","size","set","cached"],"sources":["/home/yasmin/Ãrea de Trabalho/Frontend/node_modules/ndarray-gradient/fdg.js"],"sourcesContent":["'use strict'\n\nmodule.exports      = gradient\n\nvar dup             = require('dup')\nvar cwiseCompiler   = require('cwise-compiler')\n\nvar TEMPLATE_CACHE  = {}\nvar GRADIENT_CACHE  = {}\n\nvar EmptyProc = {\n  body: \"\",\n  args: [],\n  thisVars: [],\n  localVars: []\n}\n\nvar centralDiff = cwiseCompiler({\n  args: [ 'array', 'array', 'array' ],\n  pre: EmptyProc,\n  post: EmptyProc,\n  body: {\n    args: [ {\n      name: 'out', \n      lvalue: true,\n      rvalue: false,\n      count: 1\n    }, {\n      name: 'left', \n      lvalue: false,\n      rvalue: true,\n      count: 1\n    }, {\n      name: 'right', \n      lvalue: false,\n      rvalue: true,\n      count: 1\n    }],\n    body: \"out=0.5*(left-right)\",\n    thisVars: [],\n    localVars: []\n  },\n  funcName: 'cdiff'\n})\n\nvar zeroOut = cwiseCompiler({\n  args: [ 'array' ],\n  pre: EmptyProc,\n  post: EmptyProc,\n  body: {\n    args: [ {\n      name: 'out', \n      lvalue: true,\n      rvalue: false,\n      count: 1\n    }],\n    body: \"out=0\",\n    thisVars: [],\n    localVars: []\n  },\n  funcName: 'zero'\n})\n\nfunction generateTemplate(d) {\n  if(d in TEMPLATE_CACHE) {\n    return TEMPLATE_CACHE[d]\n  }\n  var code = []\n  for(var i=0; i<d; ++i) {\n    code.push('out', i, 's=0.5*(inp', i, 'l-inp', i, 'r);')\n  }\n  var args = [ 'array' ]\n  var names = ['junk']\n  for(var i=0; i<d; ++i) {\n    args.push('array')\n    names.push('out' + i + 's')\n    var o = dup(d)\n    o[i] = -1\n    args.push({\n      array: 0,\n      offset: o.slice()\n    })\n    o[i] = 1\n    args.push({\n      array: 0,\n      offset: o.slice()\n    })\n    names.push('inp' + i + 'l', 'inp' + i + 'r')\n  }\n  return TEMPLATE_CACHE[d] = cwiseCompiler({\n    args: args,\n    pre:  EmptyProc,\n    post: EmptyProc,\n    body: {\n      body: code.join(''),\n      args: names.map(function(n) {\n        return {\n          name: n,\n          lvalue: n.indexOf('out') === 0,\n          rvalue: n.indexOf('inp') === 0,\n          count: (n!=='junk')|0\n        }\n      }),\n      thisVars: [],\n      localVars: []\n    },\n    funcName: 'fdTemplate' + d\n  })\n}\n\nfunction generateGradient(boundaryConditions) {\n  var token = boundaryConditions.join()\n  var proc = GRADIENT_CACHE[token]\n  if(proc) {\n    return proc\n  }\n\n  var d = boundaryConditions.length\n  var code = ['function gradient(dst,src){var s=src.shape.slice();' ]\n  \n  function handleBoundary(facet) {\n    var cod = d - facet.length\n\n    var loStr = []\n    var hiStr = []\n    var pickStr = []\n    for(var i=0; i<d; ++i) {\n      if(facet.indexOf(i+1) >= 0) {\n        pickStr.push('0')\n      } else if(facet.indexOf(-(i+1)) >= 0) {\n        pickStr.push('s['+i+']-1')\n      } else {\n        pickStr.push('-1')\n        loStr.push('1')\n        hiStr.push('s['+i+']-2')\n      }\n    }\n    var boundStr = '.lo(' + loStr.join() + ').hi(' + hiStr.join() + ')'\n    if(loStr.length === 0) {\n      boundStr = ''\n    }\n        \n    if(cod > 0) {\n      code.push('if(1') \n      for(var i=0; i<d; ++i) {\n        if(facet.indexOf(i+1) >= 0 || facet.indexOf(-(i+1)) >= 0) {\n          continue\n        }\n        code.push('&&s[', i, ']>2')\n      }\n      code.push('){grad', cod, '(src.pick(', pickStr.join(), ')', boundStr)\n      for(var i=0; i<d; ++i) {\n        if(facet.indexOf(i+1) >= 0 || facet.indexOf(-(i+1)) >= 0) {\n          continue\n        }\n        code.push(',dst.pick(', pickStr.join(), ',', i, ')', boundStr)\n      }\n      code.push(');')\n    }\n\n    for(var i=0; i<facet.length; ++i) {\n      var bnd = Math.abs(facet[i])-1\n      var outStr = 'dst.pick(' + pickStr.join() + ',' + bnd + ')' + boundStr\n      switch(boundaryConditions[bnd]) {\n\n        case 'clamp':\n          var cPickStr = pickStr.slice()\n          var dPickStr = pickStr.slice()\n          if(facet[i] < 0) {\n            cPickStr[bnd] = 's[' + bnd + ']-2'\n          } else {\n            dPickStr[bnd] = '1'\n          }\n          if(cod === 0) {\n            code.push('if(s[', bnd, ']>1){dst.set(',\n              pickStr.join(), ',', bnd, ',0.5*(src.get(',\n                cPickStr.join(), ')-src.get(',\n                dPickStr.join(), ')))}else{dst.set(',\n              pickStr.join(), ',', bnd, ',0)};')\n          } else {\n            code.push('if(s[', bnd, ']>1){diff(', outStr, \n                ',src.pick(', cPickStr.join(), ')', boundStr, \n                ',src.pick(', dPickStr.join(), ')', boundStr, \n                ');}else{zero(', outStr, ');};')\n          }\n        break\n\n        case 'mirror':\n          if(cod === 0) {\n            code.push('dst.set(', pickStr.join(), ',', bnd, ',0);')\n          } else {\n            code.push('zero(', outStr, ');')\n          }\n        break\n\n        case 'wrap':\n          var aPickStr = pickStr.slice()\n          var bPickStr = pickStr.slice()\n          if(facet[i] < 0) {\n            aPickStr[bnd] = 's[' + bnd + ']-2'\n            bPickStr[bnd] = '0'\n            \n          } else {\n            aPickStr[bnd] = 's[' + bnd + ']-1'\n            bPickStr[bnd] = '1'\n          }\n          if(cod === 0) {\n            code.push('if(s[', bnd, ']>2){dst.set(',\n              pickStr.join(), ',', bnd, ',0.5*(src.get(',\n                aPickStr.join(), ')-src.get(',\n                bPickStr.join(), ')))}else{dst.set(',\n              pickStr.join(), ',', bnd, ',0)};')\n          } else {\n            code.push('if(s[', bnd, ']>2){diff(', outStr, \n                ',src.pick(', aPickStr.join(), ')', boundStr, \n                ',src.pick(', bPickStr.join(), ')', boundStr, \n                ');}else{zero(', outStr, ');};')\n          }\n        break\n\n        default:\n          throw new Error('ndarray-gradient: Invalid boundary condition')\n      }\n    }\n\n    if(cod > 0) {\n      code.push('};')\n    }\n  }\n\n  //Enumerate ridges, facets, etc. of hypercube\n  for(var i=0; i<(1<<d); ++i) {\n    var faces = []\n    for(var j=0; j<d; ++j) {\n      if(i & (1<<j)) {\n        faces.push(j+1)\n      }\n    }\n    for(var k=0; k<(1<<faces.length); ++k) {\n      var sfaces = faces.slice()\n      for(var j=0; j<faces.length; ++j) {\n        if(k & (1<<j)) {\n          sfaces[j] = -sfaces[j]\n        }\n      }\n      handleBoundary(sfaces)\n    }\n  }\n\n  code.push('return dst;};return gradient')\n\n  //Compile and link routine, save cached procedure\n  var linkNames = [ 'diff', 'zero' ]\n  var linkArgs  = [ centralDiff, zeroOut ]\n  for(var i=1; i<=d; ++i) {\n    linkNames.push('grad' + i)\n    linkArgs.push(generateTemplate(i))\n  }\n  linkNames.push(code.join(''))\n\n  var link = Function.apply(void 0, linkNames)\n  var proc = link.apply(void 0, linkArgs)\n  TEMPLATE_CACHE[token] = proc\n  return proc\n}\n\nfunction gradient(out, inp, bc) {\n  if(Array.isArray(bc)) {\n    if(bc.length !== inp.dimension) {\n      throw new Error('ndarray-gradient: invalid boundary conditions')\n    }\n  } else if(typeof bc === 'string') {\n    bc = dup(inp.dimension, bc)\n  } else {\n    bc = dup(inp.dimension, 'clamp')\n  }\n  if(out.dimension !== inp.dimension + 1) {\n    throw new Error('ndarray-gradient: output dimension must be +1 input dimension')\n  }\n  if(out.shape[inp.dimension] !== inp.dimension) {\n    throw new Error('ndarray-gradient: output shape must match input shape')\n  }\n  for(var i=0; i<inp.dimension; ++i) {\n    if(out.shape[i] !== inp.shape[i]) {\n      throw new Error('ndarray-gradient: shape mismatch')\n    }\n  }\n  if(inp.size === 0) {\n    return out\n  }\n  if(inp.dimension <= 0) {\n    out.set(0)\n    return out\n  }\n  var cached = generateGradient(bc)\n  return cached(out, inp)\n}"],"mappings":"AAAA,YAAY;;AAEZA,MAAM,CAACC,OAAO,GAAQC,QAAQ;AAE9B,IAAIC,GAAG,GAAeC,OAAO,CAAC,KAAK,CAAC;AACpC,IAAIC,aAAa,GAAKD,OAAO,CAAC,gBAAgB,CAAC;AAE/C,IAAIE,cAAc,GAAI,CAAC,CAAC;AACxB,IAAIC,cAAc,GAAI,CAAC,CAAC;AAExB,IAAIC,SAAS,GAAG;EACdC,IAAI,EAAE,EAAE;EACRC,IAAI,EAAE,EAAE;EACRC,QAAQ,EAAE,EAAE;EACZC,SAAS,EAAE;AACb,CAAC;AAED,IAAIC,WAAW,GAAGR,aAAa,CAAC;EAC9BK,IAAI,EAAE,CAAE,OAAO,EAAE,OAAO,EAAE,OAAO,CAAE;EACnCI,GAAG,EAAEN,SAAS;EACdO,IAAI,EAAEP,SAAS;EACfC,IAAI,EAAE;IACJC,IAAI,EAAE,CAAE;MACNM,IAAI,EAAE,KAAK;MACXC,MAAM,EAAE,IAAI;MACZC,MAAM,EAAE,KAAK;MACbC,KAAK,EAAE;IACT,CAAC,EAAE;MACDH,IAAI,EAAE,MAAM;MACZC,MAAM,EAAE,KAAK;MACbC,MAAM,EAAE,IAAI;MACZC,KAAK,EAAE;IACT,CAAC,EAAE;MACDH,IAAI,EAAE,OAAO;MACbC,MAAM,EAAE,KAAK;MACbC,MAAM,EAAE,IAAI;MACZC,KAAK,EAAE;IACT,CAAC,CAAC;IACFV,IAAI,EAAE,sBAAsB;IAC5BE,QAAQ,EAAE,EAAE;IACZC,SAAS,EAAE;EACb,CAAC;EACDQ,QAAQ,EAAE;AACZ,CAAC,CAAC;AAEF,IAAIC,OAAO,GAAGhB,aAAa,CAAC;EAC1BK,IAAI,EAAE,CAAE,OAAO,CAAE;EACjBI,GAAG,EAAEN,SAAS;EACdO,IAAI,EAAEP,SAAS;EACfC,IAAI,EAAE;IACJC,IAAI,EAAE,CAAE;MACNM,IAAI,EAAE,KAAK;MACXC,MAAM,EAAE,IAAI;MACZC,MAAM,EAAE,KAAK;MACbC,KAAK,EAAE;IACT,CAAC,CAAC;IACFV,IAAI,EAAE,OAAO;IACbE,QAAQ,EAAE,EAAE;IACZC,SAAS,EAAE;EACb,CAAC;EACDQ,QAAQ,EAAE;AACZ,CAAC,CAAC;AAEF,SAASE,gBAAgB,CAACC,CAAC,EAAE;EAC3B,IAAGA,CAAC,IAAIjB,cAAc,EAAE;IACtB,OAAOA,cAAc,CAACiB,CAAC,CAAC;EAC1B;EACA,IAAIC,IAAI,GAAG,EAAE;EACb,KAAI,IAAIC,CAAC,GAAC,CAAC,EAAEA,CAAC,GAACF,CAAC,EAAE,EAAEE,CAAC,EAAE;IACrBD,IAAI,CAACE,IAAI,CAAC,KAAK,EAAED,CAAC,EAAE,YAAY,EAAEA,CAAC,EAAE,OAAO,EAAEA,CAAC,EAAE,KAAK,CAAC;EACzD;EACA,IAAIf,IAAI,GAAG,CAAE,OAAO,CAAE;EACtB,IAAIiB,KAAK,GAAG,CAAC,MAAM,CAAC;EACpB,KAAI,IAAIF,CAAC,GAAC,CAAC,EAAEA,CAAC,GAACF,CAAC,EAAE,EAAEE,CAAC,EAAE;IACrBf,IAAI,CAACgB,IAAI,CAAC,OAAO,CAAC;IAClBC,KAAK,CAACD,IAAI,CAAC,KAAK,GAAGD,CAAC,GAAG,GAAG,CAAC;IAC3B,IAAIG,CAAC,GAAGzB,GAAG,CAACoB,CAAC,CAAC;IACdK,CAAC,CAACH,CAAC,CAAC,GAAG,CAAC,CAAC;IACTf,IAAI,CAACgB,IAAI,CAAC;MACRG,KAAK,EAAE,CAAC;MACRC,MAAM,EAAEF,CAAC,CAACG,KAAK;IACjB,CAAC,CAAC;IACFH,CAAC,CAACH,CAAC,CAAC,GAAG,CAAC;IACRf,IAAI,CAACgB,IAAI,CAAC;MACRG,KAAK,EAAE,CAAC;MACRC,MAAM,EAAEF,CAAC,CAACG,KAAK;IACjB,CAAC,CAAC;IACFJ,KAAK,CAACD,IAAI,CAAC,KAAK,GAAGD,CAAC,GAAG,GAAG,EAAE,KAAK,GAAGA,CAAC,GAAG,GAAG,CAAC;EAC9C;EACA,OAAOnB,cAAc,CAACiB,CAAC,CAAC,GAAGlB,aAAa,CAAC;IACvCK,IAAI,EAAEA,IAAI;IACVI,GAAG,EAAGN,SAAS;IACfO,IAAI,EAAEP,SAAS;IACfC,IAAI,EAAE;MACJA,IAAI,EAAEe,IAAI,CAACQ,IAAI,CAAC,EAAE,CAAC;MACnBtB,IAAI,EAAEiB,KAAK,CAACM,GAAG,CAAC,UAASC,CAAC,EAAE;QAC1B,OAAO;UACLlB,IAAI,EAAEkB,CAAC;UACPjB,MAAM,EAAEiB,CAAC,CAACC,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC;UAC9BjB,MAAM,EAAEgB,CAAC,CAACC,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC;UAC9BhB,KAAK,EAAGe,CAAC,KAAG,MAAM,GAAE;QACtB,CAAC;MACH,CAAC,CAAC;MACFvB,QAAQ,EAAE,EAAE;MACZC,SAAS,EAAE;IACb,CAAC;IACDQ,QAAQ,EAAE,YAAY,GAAGG;EAC3B,CAAC,CAAC;AACJ;AAEA,SAASa,gBAAgB,CAACC,kBAAkB,EAAE;EAC5C,IAAIC,KAAK,GAAGD,kBAAkB,CAACL,IAAI,EAAE;EACrC,IAAIO,IAAI,GAAGhC,cAAc,CAAC+B,KAAK,CAAC;EAChC,IAAGC,IAAI,EAAE;IACP,OAAOA,IAAI;EACb;EAEA,IAAIhB,CAAC,GAAGc,kBAAkB,CAACG,MAAM;EACjC,IAAIhB,IAAI,GAAG,CAAC,qDAAqD,CAAE;EAEnE,SAASiB,cAAc,CAACC,KAAK,EAAE;IAC7B,IAAIC,GAAG,GAAGpB,CAAC,GAAGmB,KAAK,CAACF,MAAM;IAE1B,IAAII,KAAK,GAAG,EAAE;IACd,IAAIC,KAAK,GAAG,EAAE;IACd,IAAIC,OAAO,GAAG,EAAE;IAChB,KAAI,IAAIrB,CAAC,GAAC,CAAC,EAAEA,CAAC,GAACF,CAAC,EAAE,EAAEE,CAAC,EAAE;MACrB,IAAGiB,KAAK,CAACP,OAAO,CAACV,CAAC,GAAC,CAAC,CAAC,IAAI,CAAC,EAAE;QAC1BqB,OAAO,CAACpB,IAAI,CAAC,GAAG,CAAC;MACnB,CAAC,MAAM,IAAGgB,KAAK,CAACP,OAAO,CAAC,EAAEV,CAAC,GAAC,CAAC,CAAC,CAAC,IAAI,CAAC,EAAE;QACpCqB,OAAO,CAACpB,IAAI,CAAC,IAAI,GAACD,CAAC,GAAC,KAAK,CAAC;MAC5B,CAAC,MAAM;QACLqB,OAAO,CAACpB,IAAI,CAAC,IAAI,CAAC;QAClBkB,KAAK,CAAClB,IAAI,CAAC,GAAG,CAAC;QACfmB,KAAK,CAACnB,IAAI,CAAC,IAAI,GAACD,CAAC,GAAC,KAAK,CAAC;MAC1B;IACF;IACA,IAAIsB,QAAQ,GAAG,MAAM,GAAGH,KAAK,CAACZ,IAAI,EAAE,GAAG,OAAO,GAAGa,KAAK,CAACb,IAAI,EAAE,GAAG,GAAG;IACnE,IAAGY,KAAK,CAACJ,MAAM,KAAK,CAAC,EAAE;MACrBO,QAAQ,GAAG,EAAE;IACf;IAEA,IAAGJ,GAAG,GAAG,CAAC,EAAE;MACVnB,IAAI,CAACE,IAAI,CAAC,MAAM,CAAC;MACjB,KAAI,IAAID,CAAC,GAAC,CAAC,EAAEA,CAAC,GAACF,CAAC,EAAE,EAAEE,CAAC,EAAE;QACrB,IAAGiB,KAAK,CAACP,OAAO,CAACV,CAAC,GAAC,CAAC,CAAC,IAAI,CAAC,IAAIiB,KAAK,CAACP,OAAO,CAAC,EAAEV,CAAC,GAAC,CAAC,CAAC,CAAC,IAAI,CAAC,EAAE;UACxD;QACF;QACAD,IAAI,CAACE,IAAI,CAAC,MAAM,EAAED,CAAC,EAAE,KAAK,CAAC;MAC7B;MACAD,IAAI,CAACE,IAAI,CAAC,QAAQ,EAAEiB,GAAG,EAAE,YAAY,EAAEG,OAAO,CAACd,IAAI,EAAE,EAAE,GAAG,EAAEe,QAAQ,CAAC;MACrE,KAAI,IAAItB,CAAC,GAAC,CAAC,EAAEA,CAAC,GAACF,CAAC,EAAE,EAAEE,CAAC,EAAE;QACrB,IAAGiB,KAAK,CAACP,OAAO,CAACV,CAAC,GAAC,CAAC,CAAC,IAAI,CAAC,IAAIiB,KAAK,CAACP,OAAO,CAAC,EAAEV,CAAC,GAAC,CAAC,CAAC,CAAC,IAAI,CAAC,EAAE;UACxD;QACF;QACAD,IAAI,CAACE,IAAI,CAAC,YAAY,EAAEoB,OAAO,CAACd,IAAI,EAAE,EAAE,GAAG,EAAEP,CAAC,EAAE,GAAG,EAAEsB,QAAQ,CAAC;MAChE;MACAvB,IAAI,CAACE,IAAI,CAAC,IAAI,CAAC;IACjB;IAEA,KAAI,IAAID,CAAC,GAAC,CAAC,EAAEA,CAAC,GAACiB,KAAK,CAACF,MAAM,EAAE,EAAEf,CAAC,EAAE;MAChC,IAAIuB,GAAG,GAAGC,IAAI,CAACC,GAAG,CAACR,KAAK,CAACjB,CAAC,CAAC,CAAC,GAAC,CAAC;MAC9B,IAAI0B,MAAM,GAAG,WAAW,GAAGL,OAAO,CAACd,IAAI,EAAE,GAAG,GAAG,GAAGgB,GAAG,GAAG,GAAG,GAAGD,QAAQ;MACtE,QAAOV,kBAAkB,CAACW,GAAG,CAAC;QAE5B,KAAK,OAAO;UACV,IAAII,QAAQ,GAAGN,OAAO,CAACf,KAAK,EAAE;UAC9B,IAAIsB,QAAQ,GAAGP,OAAO,CAACf,KAAK,EAAE;UAC9B,IAAGW,KAAK,CAACjB,CAAC,CAAC,GAAG,CAAC,EAAE;YACf2B,QAAQ,CAACJ,GAAG,CAAC,GAAG,IAAI,GAAGA,GAAG,GAAG,KAAK;UACpC,CAAC,MAAM;YACLK,QAAQ,CAACL,GAAG,CAAC,GAAG,GAAG;UACrB;UACA,IAAGL,GAAG,KAAK,CAAC,EAAE;YACZnB,IAAI,CAACE,IAAI,CAAC,OAAO,EAAEsB,GAAG,EAAE,eAAe,EACrCF,OAAO,CAACd,IAAI,EAAE,EAAE,GAAG,EAAEgB,GAAG,EAAE,gBAAgB,EACxCI,QAAQ,CAACpB,IAAI,EAAE,EAAE,YAAY,EAC7BqB,QAAQ,CAACrB,IAAI,EAAE,EAAE,mBAAmB,EACtCc,OAAO,CAACd,IAAI,EAAE,EAAE,GAAG,EAAEgB,GAAG,EAAE,OAAO,CAAC;UACtC,CAAC,MAAM;YACLxB,IAAI,CAACE,IAAI,CAAC,OAAO,EAAEsB,GAAG,EAAE,YAAY,EAAEG,MAAM,EACxC,YAAY,EAAEC,QAAQ,CAACpB,IAAI,EAAE,EAAE,GAAG,EAAEe,QAAQ,EAC5C,YAAY,EAAEM,QAAQ,CAACrB,IAAI,EAAE,EAAE,GAAG,EAAEe,QAAQ,EAC5C,eAAe,EAAEI,MAAM,EAAE,MAAM,CAAC;UACtC;UACF;QAEA,KAAK,QAAQ;UACX,IAAGR,GAAG,KAAK,CAAC,EAAE;YACZnB,IAAI,CAACE,IAAI,CAAC,UAAU,EAAEoB,OAAO,CAACd,IAAI,EAAE,EAAE,GAAG,EAAEgB,GAAG,EAAE,MAAM,CAAC;UACzD,CAAC,MAAM;YACLxB,IAAI,CAACE,IAAI,CAAC,OAAO,EAAEyB,MAAM,EAAE,IAAI,CAAC;UAClC;UACF;QAEA,KAAK,MAAM;UACT,IAAIG,QAAQ,GAAGR,OAAO,CAACf,KAAK,EAAE;UAC9B,IAAIwB,QAAQ,GAAGT,OAAO,CAACf,KAAK,EAAE;UAC9B,IAAGW,KAAK,CAACjB,CAAC,CAAC,GAAG,CAAC,EAAE;YACf6B,QAAQ,CAACN,GAAG,CAAC,GAAG,IAAI,GAAGA,GAAG,GAAG,KAAK;YAClCO,QAAQ,CAACP,GAAG,CAAC,GAAG,GAAG;UAErB,CAAC,MAAM;YACLM,QAAQ,CAACN,GAAG,CAAC,GAAG,IAAI,GAAGA,GAAG,GAAG,KAAK;YAClCO,QAAQ,CAACP,GAAG,CAAC,GAAG,GAAG;UACrB;UACA,IAAGL,GAAG,KAAK,CAAC,EAAE;YACZnB,IAAI,CAACE,IAAI,CAAC,OAAO,EAAEsB,GAAG,EAAE,eAAe,EACrCF,OAAO,CAACd,IAAI,EAAE,EAAE,GAAG,EAAEgB,GAAG,EAAE,gBAAgB,EACxCM,QAAQ,CAACtB,IAAI,EAAE,EAAE,YAAY,EAC7BuB,QAAQ,CAACvB,IAAI,EAAE,EAAE,mBAAmB,EACtCc,OAAO,CAACd,IAAI,EAAE,EAAE,GAAG,EAAEgB,GAAG,EAAE,OAAO,CAAC;UACtC,CAAC,MAAM;YACLxB,IAAI,CAACE,IAAI,CAAC,OAAO,EAAEsB,GAAG,EAAE,YAAY,EAAEG,MAAM,EACxC,YAAY,EAAEG,QAAQ,CAACtB,IAAI,EAAE,EAAE,GAAG,EAAEe,QAAQ,EAC5C,YAAY,EAAEQ,QAAQ,CAACvB,IAAI,EAAE,EAAE,GAAG,EAAEe,QAAQ,EAC5C,eAAe,EAAEI,MAAM,EAAE,MAAM,CAAC;UACtC;UACF;QAEA;UACE,MAAM,IAAIK,KAAK,CAAC,8CAA8C,CAAC;MAAA;IAErE;IAEA,IAAGb,GAAG,GAAG,CAAC,EAAE;MACVnB,IAAI,CAACE,IAAI,CAAC,IAAI,CAAC;IACjB;EACF;;EAEA;EACA,KAAI,IAAID,CAAC,GAAC,CAAC,EAAEA,CAAC,GAAE,CAAC,IAAEF,CAAE,EAAE,EAAEE,CAAC,EAAE;IAC1B,IAAIgC,KAAK,GAAG,EAAE;IACd,KAAI,IAAIC,CAAC,GAAC,CAAC,EAAEA,CAAC,GAACnC,CAAC,EAAE,EAAEmC,CAAC,EAAE;MACrB,IAAGjC,CAAC,GAAI,CAAC,IAAEiC,CAAE,EAAE;QACbD,KAAK,CAAC/B,IAAI,CAACgC,CAAC,GAAC,CAAC,CAAC;MACjB;IACF;IACA,KAAI,IAAIC,CAAC,GAAC,CAAC,EAAEA,CAAC,GAAE,CAAC,IAAEF,KAAK,CAACjB,MAAO,EAAE,EAAEmB,CAAC,EAAE;MACrC,IAAIC,MAAM,GAAGH,KAAK,CAAC1B,KAAK,EAAE;MAC1B,KAAI,IAAI2B,CAAC,GAAC,CAAC,EAAEA,CAAC,GAACD,KAAK,CAACjB,MAAM,EAAE,EAAEkB,CAAC,EAAE;QAChC,IAAGC,CAAC,GAAI,CAAC,IAAED,CAAE,EAAE;UACbE,MAAM,CAACF,CAAC,CAAC,GAAG,CAACE,MAAM,CAACF,CAAC,CAAC;QACxB;MACF;MACAjB,cAAc,CAACmB,MAAM,CAAC;IACxB;EACF;EAEApC,IAAI,CAACE,IAAI,CAAC,8BAA8B,CAAC;;EAEzC;EACA,IAAImC,SAAS,GAAG,CAAE,MAAM,EAAE,MAAM,CAAE;EAClC,IAAIC,QAAQ,GAAI,CAAEjD,WAAW,EAAEQ,OAAO,CAAE;EACxC,KAAI,IAAII,CAAC,GAAC,CAAC,EAAEA,CAAC,IAAEF,CAAC,EAAE,EAAEE,CAAC,EAAE;IACtBoC,SAAS,CAACnC,IAAI,CAAC,MAAM,GAAGD,CAAC,CAAC;IAC1BqC,QAAQ,CAACpC,IAAI,CAACJ,gBAAgB,CAACG,CAAC,CAAC,CAAC;EACpC;EACAoC,SAAS,CAACnC,IAAI,CAACF,IAAI,CAACQ,IAAI,CAAC,EAAE,CAAC,CAAC;EAE7B,IAAI+B,IAAI,GAAGC,QAAQ,CAACC,KAAK,CAAC,KAAK,CAAC,EAAEJ,SAAS,CAAC;EAC5C,IAAItB,IAAI,GAAGwB,IAAI,CAACE,KAAK,CAAC,KAAK,CAAC,EAAEH,QAAQ,CAAC;EACvCxD,cAAc,CAACgC,KAAK,CAAC,GAAGC,IAAI;EAC5B,OAAOA,IAAI;AACb;AAEA,SAASrC,QAAQ,CAACgE,GAAG,EAAEC,GAAG,EAAEC,EAAE,EAAE;EAC9B,IAAGC,KAAK,CAACC,OAAO,CAACF,EAAE,CAAC,EAAE;IACpB,IAAGA,EAAE,CAAC5B,MAAM,KAAK2B,GAAG,CAACI,SAAS,EAAE;MAC9B,MAAM,IAAIf,KAAK,CAAC,+CAA+C,CAAC;IAClE;EACF,CAAC,MAAM,IAAG,OAAOY,EAAE,KAAK,QAAQ,EAAE;IAChCA,EAAE,GAAGjE,GAAG,CAACgE,GAAG,CAACI,SAAS,EAAEH,EAAE,CAAC;EAC7B,CAAC,MAAM;IACLA,EAAE,GAAGjE,GAAG,CAACgE,GAAG,CAACI,SAAS,EAAE,OAAO,CAAC;EAClC;EACA,IAAGL,GAAG,CAACK,SAAS,KAAKJ,GAAG,CAACI,SAAS,GAAG,CAAC,EAAE;IACtC,MAAM,IAAIf,KAAK,CAAC,+DAA+D,CAAC;EAClF;EACA,IAAGU,GAAG,CAACM,KAAK,CAACL,GAAG,CAACI,SAAS,CAAC,KAAKJ,GAAG,CAACI,SAAS,EAAE;IAC7C,MAAM,IAAIf,KAAK,CAAC,uDAAuD,CAAC;EAC1E;EACA,KAAI,IAAI/B,CAAC,GAAC,CAAC,EAAEA,CAAC,GAAC0C,GAAG,CAACI,SAAS,EAAE,EAAE9C,CAAC,EAAE;IACjC,IAAGyC,GAAG,CAACM,KAAK,CAAC/C,CAAC,CAAC,KAAK0C,GAAG,CAACK,KAAK,CAAC/C,CAAC,CAAC,EAAE;MAChC,MAAM,IAAI+B,KAAK,CAAC,kCAAkC,CAAC;IACrD;EACF;EACA,IAAGW,GAAG,CAACM,IAAI,KAAK,CAAC,EAAE;IACjB,OAAOP,GAAG;EACZ;EACA,IAAGC,GAAG,CAACI,SAAS,IAAI,CAAC,EAAE;IACrBL,GAAG,CAACQ,GAAG,CAAC,CAAC,CAAC;IACV,OAAOR,GAAG;EACZ;EACA,IAAIS,MAAM,GAAGvC,gBAAgB,CAACgC,EAAE,CAAC;EACjC,OAAOO,MAAM,CAACT,GAAG,EAAEC,GAAG,CAAC;AACzB"},"metadata":{},"sourceType":"script","externalDependencies":[]}